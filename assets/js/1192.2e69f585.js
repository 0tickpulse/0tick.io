"use strict";(self.webpackChunk_0_tick_io=self.webpackChunk_0_tick_io||[]).push([["1192"],{58235:function(__unused_webpack_module,exports,__webpack_require__){var numeric=exports;void 0!==__webpack_require__.g&&(__webpack_require__.g.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,n){var e,t,o,i;for(void 0===n&&(n=15),o=.5,e=new Date;;){for(o*=2,i=o;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if((t=new Date)-e>n)break}for(i=o;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return 1e3*(3*o-1)/((t=new Date)-e)},numeric._myIndexOf=function(r){var n,e=this.length;for(n=0;n<e;++n)if(this[n]===r)return n;return -1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function n(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+n(-r);if(isFinite(r)){var e=Math.floor(Math.log(r)/Math.log(10)),t=r/Math.pow(10,e),o=t.toPrecision(numeric.precision);return 10===parseFloat(o)&&(e++,o=(t=1).toPrecision(numeric.precision)),parseFloat(o).toString()+"e"+e.toString()}return"Infinity"}var e=[];function t(r){if(void 0===r)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return e.push('"'+r+'"'),!1;if("boolean"==typeof r)return e.push(r.toString()),!1;if("number"==typeof r){var o,i=n(r),a=r.toPrecision(numeric.precision),f=parseFloat(r.toString()).toString(),u=[i,a,f,parseFloat(a).toString(),parseFloat(f).toString()];for(o=1;o<u.length;o++)u[o].length<i.length&&(i=u[o]);return e.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===r)return e.push("null"),!1;if("function"==typeof r){e.push(r.toString());var s=!1;for(o in r)r.hasOwnProperty(o)&&(s?e.push(",\n"):e.push("\n{"),s=!0,e.push(o),e.push(": \n"),t(r[o]));return s&&e.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return e.push("...Large Array..."),!0;var s=!1;for(e.push("["),o=0;o<r.length;o++)o>0&&(e.push(","),s&&e.push("\n ")),s=t(r[o]);return e.push("]"),!0}e.push("{");var s=!1;for(o in r)r.hasOwnProperty(o)&&(s&&e.push(",\n"),s=!0,e.push(o),e.push(": \n"),t(r[o]));return e.push("}"),!0}return t(r),e.join("")},numeric.parseDate=function(r){function n(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw Error("parseDate: parameter must be arrays of strings");var e,t=[];for(e=0;e<r.length;e++)t[e]=n(r[e]);return t}return n(r)},numeric.parseFloat=function(r){function n(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw Error("parseFloat: parameter must be arrays of strings");var e,t=[];for(e=0;e<r.length;e++)t[e]=n(r[e]);return t}return n(r)},numeric.parseCSV=function(r){var n=r.split("\n"),e=[],t=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,i=function(r){return r.substr(0,r.length-1)},a=0;for(u=0;u<n.length;u++){var f,u,s,c=(n[u]+",").match(t);if(c.length>0){for(f=0,e[a]=[];f<c.length;f++)s=i(c[f]),o.test(s)?e[a][f]=parseFloat(s):e[a][f]=s;a++}}return e},numeric.toCSV=function(r){var n,e,t,o,i,a,f=numeric.dim(r);for(n=0,t=f[0],o=f[1],a=[];n<t;n++){for(e=0,i=[];e<t;e++)i[e]=r[n][e].toString();a[n]=i.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r){var n,e,t,o,i,a,f,u,s=r.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(n=0;n<s;n+=3)e=r[n],t=r[n+1],o=r[n+2],i=e>>2,a=((3&e)<<4)+(t>>4),f=((15&t)<<2)+(o>>6),u=63&o,n+1>=s?f=u=64:n+2>=s&&(u=64),h+=c.charAt(i)+c.charAt(a)+c.charAt(f)+c.charAt(u);return h}function e(r,n,e){void 0===n&&(n=0),void 0===e&&(e=r.length);var t,o=[0,0x77073096,0xee0e612c,0x990951ba,0x76dc419,0x706af48f,0xe963a535,0x9e6495a3,0xedb8832,0x79dcb8a4,0xe0d5e91e,0x97d2d988,0x9b64c2b,0x7eb17cbd,0xe7b82d07,0x90bf1d91,0x1db71064,0x6ab020f2,0xf3b97148,0x84be41de,0x1adad47d,0x6ddde4eb,0xf4d4b551,0x83d385c7,0x136c9856,0x646ba8c0,0xfd62f97a,0x8a65c9ec,0x14015c4f,0x63066cd9,0xfa0f3d63,0x8d080df5,0x3b6e20c8,0x4c69105e,0xd56041e4,0xa2677172,0x3c03e4d1,0x4b04d447,0xd20d85fd,0xa50ab56b,0x35b5a8fa,0x42b2986c,0xdbbbc9d6,0xacbcf940,0x32d86ce3,0x45df5c75,0xdcd60dcf,0xabd13d59,0x26d930ac,0x51de003a,0xc8d75180,0xbfd06116,0x21b4f4b5,0x56b3c423,0xcfba9599,0xb8bda50f,0x2802b89e,0x5f058808,0xc60cd9b2,0xb10be924,0x2f6f7c87,0x58684c11,0xc1611dab,0xb6662d3d,0x76dc4190,0x1db7106,0x98d220bc,0xefd5102a,0x71b18589,0x6b6b51f,0x9fbfe4a5,0xe8b8d433,0x7807c9a2,0xf00f934,0x9609a88e,0xe10e9818,0x7f6a0dbb,0x86d3d2d,0x91646c97,0xe6635c01,0x6b6b51f4,0x1c6c6162,0x856530d8,0xf262004e,0x6c0695ed,0x1b01a57b,0x8208f4c1,0xf50fc457,0x65b0d9c6,0x12b7e950,0x8bbeb8ea,0xfcb9887c,0x62dd1ddf,0x15da2d49,0x8cd37cf3,0xfbd44c65,0x4db26158,0x3ab551ce,0xa3bc0074,0xd4bb30e2,0x4adfa541,0x3dd895d7,0xa4d1c46d,0xd3d6f4fb,0x4369e96a,0x346ed9fc,0xad678846,0xda60b8d0,0x44042d73,0x33031de5,0xaa0a4c5f,0xdd0d7cc9,0x5005713c,0x270241aa,0xbe0b1010,0xc90c2086,0x5768b525,0x206f85b3,0xb966d409,0xce61e49f,0x5edef90e,0x29d9c998,0xb0d09822,0xc7d7a8b4,0x59b33d17,0x2eb40d81,0xb7bd5c3b,0xc0ba6cad,0xedb88320,0x9abfb3b6,0x3b6e20c,0x74b1d29a,0xead54739,0x9dd277af,0x4db2615,0x73dc1683,0xe3630b12,0x94643b84,0xd6d6a3e,0x7a6a5aa8,0xe40ecf0b,0x9309ff9d,0xa00ae27,0x7d079eb1,0xf00f9344,0x8708a3d2,0x1e01f268,0x6906c2fe,0xf762575d,0x806567cb,0x196c3671,0x6e6b06e7,0xfed41b76,0x89d32be0,0x10da7a5a,0x67dd4acc,0xf9b9df6f,0x8ebeeff9,0x17b7be43,0x60b08ed5,0xd6d6a3e8,0xa1d1937e,0x38d8c2c4,0x4fdff252,0xd1bb67f1,0xa6bc5767,0x3fb506dd,0x48b2364b,0xd80d2bda,0xaf0a1b4c,0x36034af6,0x41047a60,0xdf60efc3,0xa867df55,0x316e8eef,0x4669be79,0xcb61b38c,0xbc66831a,0x256fd2a0,0x5268e236,0xcc0c7795,0xbb0b4703,0x220216b9,0x5505262f,0xc5ba3bbe,0xb2bd0b28,0x2bb45a92,0x5cb36a04,0xc2d7ffa7,0xb5d0cf31,0x2cd99e8b,0x5bdeae1d,0x9b64c2b0,0xec63f226,0x756aa39c,0x26d930a,0x9c0906a9,0xeb0e363f,0x72076785,0x5005713,0x95bf4a82,0xe2b87a14,0x7bb12bae,0xcb61b38,0x92d28e9b,0xe5d5be0d,0x7cdcefb7,0xbdbdf21,0x86d3d2d4,0xf1d4e242,0x68ddb3f8,0x1fda836e,0x81be16cd,0xf6b9265b,0x6fb077e1,0x18b74777,0x88085ae6,0xff0f6a70,0x66063bca,0x11010b5c,0x8f659eff,0xf862ae69,0x616bffd3,0x166ccf45,0xa00ae278,0xd70dd2ee,0x4e048354,0x3903b3c2,0xa7672661,0xd06016f7,0x4969474d,0x3e6e77db,0xaed16a4a,0xd9d65adc,0x40df0b66,936918e3,0xa9bcae53,0xdebb9ec5,0x47b2cf7f,0x30b5ffe9,0xbdbdf21c,0xcabac28a,0x53b39330,0x24b4a3a6,0xbad03605,0xcdd70693,0x54de5729,0x23d967bf,0xb3667a2e,0xc4614ab8,0x5d681b02,0x2a6f2b94,0xb40bbe37,0xc30c8ea1,0x5a05df1b,0x2d02ef8d],i=-1,a=0;for(r.length,t=n;t<e;t++)a=(i^r[t])&255,i=i>>>8^o[a];return -1^i}var t,o,i,a,f,u,s,c,h,x,d=r[0].length,l=r[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,l>>24&255,l>>16&255,l>>8&255,255&l,d>>24&255,d>>16&255,d>>8&255,255&d,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(s=0,x=e(p,12,29),p[29]=x>>24&255,p[30]=x>>16&255,p[31]=x>>8&255,p[32]=255&x,t=1,o=0;s<d;s++){for(s<d-1?p.push(0):p.push(1),f=3*l+1+(0===s)&255,u=3*l+1+(0===s)>>8&255,p.push(f),p.push(u),p.push(255&~f),p.push(255&~u),0===s&&p.push(0),c=0;c<l;c++)for(i=0;i<3;i++)o=(o+(t=(t+(f=(f=r[i][s][c])>255?255:f<0?0:Math.round(f)))%65521))%65521,p.push(f);p.push(0)}return h=(o<<16)+t,p.push(h>>24&255),p.push(h>>16&255),p.push(h>>8&255),p.push(255&h),a=p.length-41,p[33]=a>>24&255,p[34]=a>>16&255,p[35]=a>>8&255,p[36]=255&a,x=e(p,37),p.push(x>>24&255),p.push(x>>16&255),p.push(x>>8&255),p.push(255&x),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+n(p)},numeric._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n;if("object"==typeof r)return"object"==typeof(n=r[0])?"object"==typeof n[0]?numeric._dim(r):[r.length,n.length]:[r.length];return[]},numeric.mapreduce=function(r,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(n,e){var t,o;if(!(n instanceof Array)||!(e instanceof Array)||(o=n.length)!==e.length)return!1;for(t=0;t<o;t++)if(n[t]!==e[t]){if("object"!=typeof n[t])return!1;else if(!r(n[t],e[t]))return!1}return!0},numeric.rep=function(r,n,e){void 0===e&&(e=0);var t,o=r[e],i=Array(o);if(e===r.length-1){for(t=o-2;t>=0;t-=2)i[t+1]=n,i[t]=n;return -1===t&&(i[0]=n),i}for(t=o-1;t>=0;t--)i[t]=numeric.rep(r,n,e+1);return i},numeric.dotMMsmall=function(r,n){var e,t,o,i,a,f,u,s,c,h,x;for(i=r.length,a=n.length,f=n[0].length,u=Array(i),e=i-1;e>=0;e--){for(s=Array(f),c=r[e],o=f-1;o>=0;o--){for(h=c[a-1]*n[a-1][o],t=a-2;t>=1;t-=2)x=t-1,h+=c[t]*n[t][o]+c[x]*n[x][o];0===t&&(h+=c[0]*n[0][o]),s[o]=h}u[e]=s}return u},numeric._getCol=function(r,n,e){var t;for(t=r.length-1;t>0;--t)e[t]=r[t][n],e[--t]=r[t][n];0===t&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var e,t,o,i,a=numeric._getCol,f=n.length,u=Array(f),s=r.length,c=n[0].length,h=Array(s),x=numeric.dotVV;for(--f,e=--s;-1!==e;--e)h[e]=Array(c);for(e=--c;-1!==e;--e)for(a(n,e,u),t=s;-1!==t;--t)o=0,i=r[t],h[t][e]=x(i,u);return h},numeric.dotMV=function(r,n){var e,t=r.length;n.length;var o=Array(t),i=numeric.dotVV;for(e=t-1;e>=0;e--)o[e]=i(r[e],n);return o},numeric.dotVM=function(r,n){var e,t,o,i,a,f,u;for(o=r.length,a=Array(i=n[0].length),t=i-1;t>=0;t--){for(f=r[o-1]*n[o-1][t],e=o-2;e>=1;e-=2)u=e-1,f+=r[e]*n[e][t]+r[u]*n[u][t];0===e&&(f+=r[0]*n[0][t]),a[t]=f}return a},numeric.dotVV=function(r,n){var e,t,o=r.length,i=r[o-1]*n[o-1];for(e=o-2;e>=1;e-=2)t=e-1,i+=r[e]*n[e]+r[t]*n[t];return 0===e&&(i+=r[0]*n[0]),i},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:if(n.length<10)return numeric.dotMMsmall(r,n);return numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var n,e,t,o,i=r.length,a=Array(i);for(n=i-1;n>=0;n--){for(o=Array(i),e=n+2,t=i-1;t>=e;t-=2)o[t]=0,o[t-1]=0;for(t>n&&(o[t]=0),o[n]=r[n],t=n-1;t>=1;t-=2)o[t]=0,o[t-1]=0;0===t&&(o[0]=0),a[n]=o}return a},numeric.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),t=Array(e);for(n=e-1;n>=1;--n)t[n]=r[n][n],t[--n]=r[n][n];return 0===n&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,n,e){void 0===e&&(e="");var t,o,i=[],a=/\[i\]$/,f="",u=!1;for(t=0;t<r.length;t++)a.test(r[t])?f=o=r[t].substring(0,r[t].length-3):o=r[t],"ret"===o&&(u=!0),i.push(o);return i[r.length]="_s",i[r.length+1]="_k",i[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+f+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n    "+n+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(r,n,e){void 0===e&&(e="");var t,o,i=[],a=/\[i\]$/,f="",u=!1;for(t=0;t<r.length;t++)a.test(r[t])?f=o=r[t].substring(0,r[t].length-3):o=r[t],"ret"===o&&(u=!0),i.push(o);return i[r.length]="var _n = "+f+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+n+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function r(n,e,t,o,i){var a;if(o===t.length-1)return void i(n,e);for(a=t[o]-1;a>=0;a--)r("object"==typeof n?n[a]:n,"object"==typeof e?e[a]:e,t,o+1,i)},numeric._biforeach2=function r(n,e,t,o,i){if(o===t.length-1)return i(n,e);var a,f=t[o],u=Array(f);for(a=f-1;a>=0;--a)u[a]=r("object"==typeof n?n[a]:n,"object"==typeof e?e[a]:e,t,o+1,i);return u},numeric._foreach=function r(n,e,t,o){var i;if(t===e.length-1)return void o(n);for(i=e[t]-1;i>=0;i--)r(n[i],e,t+1,o)},numeric._foreach2=function r(n,e,t,o){if(t===e.length-1)return o(n);var i,a=e[t],f=Array(a);for(i=a-1;i>=0;i--)f[i]=r(n[i],e,t+1,o);return f},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,t,o="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(o="var "+n+" = Math."+n+";\n",e=function(r,e,t){return r+" = "+n+"("+e+","+t+")"},t=function(r,e){return r+" = "+n+"("+r+","+e+")"}):(e=function(r,e,t){return r+" = "+e+" "+n+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e}:function(r,e){return r+" = "+r+" "+n+" "+e}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],e("ret[i]","x[i]","y[i]"),o),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],e("ret[i]","x","y[i]"),o),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],e("ret[i]","x[i]","y"),o),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),o),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),o),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(o="",n=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(n)&&(o="var "+n+" = Math."+n+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",o),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",o),numeric[r]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(n=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[r]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,n){return"object"==typeof r?"object"==typeof n?numeric.truncVV(r,n):numeric.truncVS(r,n):"object"==typeof n?numeric.truncSV(r,n):Math.round(r/n)*n},numeric.inv=function(r){var n,e,t,o,i,a,f,u=numeric.dim(r),s=Math.abs,c=u[0],h=u[1],x=numeric.clone(r),d=numeric.identity(c);for(e=0;e<h;++e){var l=-1,p=-1;for(n=e;n!==c;++n)(t=s(x[n][e]))>p&&(l=n,p=t);for(i=x[l],x[l]=x[e],x[e]=i,f=d[l],d[l]=d[e],d[e]=f,r=i[e],t=e;t!==h;++t)i[t]/=r;for(t=h-1;-1!==t;--t)f[t]/=r;for(n=c-1;-1!==n;--n)if(n!==e){for(o=x[n],a=d[n],r=o[e],t=e+1;t!==h;++t)o[t]-=i[t]*r;for(t=h-1;t>0;--t)a[t]-=f[t]*r,--t,a[t]-=f[t]*r;0===t&&(a[0]-=f[0]*r)}}return d},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw Error("numeric: det() only works on square matrices");var e,t,o,i,a,f,u,s,c=n[0],h=1,x=numeric.clone(r);for(t=0;t<c-1;t++){for(o=t,e=t+1;e<c;e++)Math.abs(x[e][t])>Math.abs(x[o][t])&&(o=e);for(o!==t&&(u=x[o],x[o]=x[t],x[t]=u,h*=-1),i=x[t],e=t+1;e<c;e++){for(f=(a=x[e])[t]/i[t],o=t+1;o<c-1;o+=2)s=o+1,a[o]-=i[o]*f,a[s]-=i[s]*f;o!==c&&(a[o]-=i[o]*f)}if(0===i[t])return 0;h*=i[t]}return h*x[t][t]},numeric.transpose=function(r){var n,e,t,o,i,a=r.length,f=r[0].length,u=Array(f);for(e=0;e<f;e++)u[e]=Array(a);for(n=a-1;n>=1;n-=2){for(o=r[n],t=r[n-1],e=f-1;e>=1;--e)(i=u[e])[n]=o[e],i[n-1]=t[e],(i=u[--e])[n]=o[e],i[n-1]=t[e];0===e&&((i=u[0])[n]=o[0],i[n-1]=t[0])}if(0===n){for(t=r[0],e=f-1;e>=1;--e)u[e][0]=t[e],u[--e][0]=t[e];0===e&&(u[0][0]=t[0])}return u},numeric.negtranspose=function(r){var n,e,t,o,i,a=r.length,f=r[0].length,u=Array(f);for(e=0;e<f;e++)u[e]=Array(a);for(n=a-1;n>=1;n-=2){for(o=r[n],t=r[n-1],e=f-1;e>=1;--e)(i=u[e])[n]=-o[e],i[n-1]=-t[e],(i=u[--e])[n]=-o[e],i[n-1]=-t[e];0===e&&((i=u[0])[n]=-o[0],i[n-1]=-t[0])}if(0===n){for(t=r[0],e=f-1;e>=1;--e)u[e][0]=-t[e],u[--e][0]=-t[e];0===e&&(u[0][0]=-t[0])}return u},numeric._random=function r(n,e){var t,o,i=n[e],a=Array(i);if(e===n.length-1){for(o=Math.random,t=i-1;t>=1;t-=2)a[t]=o(),a[t-1]=o();return 0===t&&(a[0]=o()),a}for(t=i-1;t>=0;t--)a[t]=r(n,e+1);return a},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,n,e){if(void 0===e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];var t,o=Array(e);for(t=--e;t>=0;t--)o[t]=(t*n+(e-t)*r)/e;return o},numeric.getBlock=function(r,n,e){var t=numeric.dim(r);function o(r,i){var a,f=n[i],u=e[i]-f,s=Array(u);if(i===t.length-1){for(a=u;a>=0;a--)s[a]=r[a+f];return s}for(a=u;a>=0;a--)s[a]=o(r[a+f],i+1);return s}return o(r,0)},numeric.setBlock=function(r,n,e,t){var o=numeric.dim(r);function i(r,t,a){var f,u=n[a],s=e[a]-u;if(a===o.length-1)for(f=s;f>=0;f--)r[f+u]=t[f];for(f=s;f>=0;f--)i(r[f+u],t[f],a+1)}return i(r,t,0),r},numeric.getRange=function(r,n,e){var t,o,i,a,f=n.length,u=e.length,s=Array(f);for(t=f-1;-1!==t;--t)for(s[t]=Array(u),i=s[t],a=r[n[t]],o=u-1;-1!==o;--o)i[o]=a[e[o]];return s},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);var e,t,o,i,a,f=n[0],u=n[1];for(o=0,e=0,t=0;o<f;++o)e+=r[o][0].length;for(i=0;i<u;++i)t+=r[0][i][0].length;var s=Array(e);for(o=0;o<e;++o)s[o]=Array(t);var c,h,x,d,l,p=0;for(o=0;o<f;++o){for(c=t,i=u-1;-1!==i;--i)for(c-=(a=r[o][i])[0].length,x=a.length-1;-1!==x;--x)for(l=a[x],h=s[p+x],d=l.length-1;-1!==d;--d)h[c+d]=l[d];p+=r[o][0].length}return s},numeric.tensor=function(r,n){if("number"==typeof r||"number"==typeof n)return numeric.mul(r,n);var e=numeric.dim(r),t=numeric.dim(n);if(1!==e.length||1!==t.length)throw Error("numeric: tensor product is only defined for vectors");var o,i,a,f,u=e[0],s=t[0],c=Array(u);for(i=u-1;i>=0;i--){for(o=Array(s),f=r[i],a=s-1;a>=3;--a)o[a]=f*n[a],o[--a]=f*n[a],o[--a]=f*n[a],o[--a]=f*n[a];for(;a>=0;)o[a]=f*n[a],--a;c[i]=o}return c},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,t,o){var i;if(numeric.indexOf,"string"!=typeof o)for(i in o="",numeric)numeric.hasOwnProperty(i)&&(r.indexOf(i)>=0||n.indexOf(i)>=0||e.indexOf(i)>=0||t.indexOf(i)>=0)&&i.length>1&&(o+="var "+i+" = numeric."+i+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+o+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new T(n(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var n=numeric.div;return this.y?new numeric.T(n(this.x,r.x),n(this.y,r.x)):new numeric.T(n(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!=typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+n+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r,n,e,t,o,i,a,f,u,s,c,h,x,d,l,p,y,g,v=this;if(void 0===v.y)return new numeric.T(numeric.inv(v.x));var u,s,c,b=v.x.length,m=numeric.identity(b),w=numeric.rep([b,b],0),M=numeric.clone(v.x),k=numeric.clone(v.y);for(u=0;u<b;u++){for(h=(d=M[u][u])*d+(l=k[u][u])*l,c=u,s=u+1;s<b;s++)(x=(d=M[s][u])*d+(l=k[s][u])*l)>h&&(c=s,h=x);for(c!==u&&(g=M[u],M[u]=M[c],M[c]=g,g=k[u],k[u]=k[c],k[c]=g,g=m[u],m[u]=m[c],m[c]=g,g=w[u],w[u]=w[c],w[c]=g),r=M[u],n=k[u],o=m[u],i=w[u],d=r[u],l=n[u],s=u+1;s<b;s++)p=r[s],y=n[s],r[s]=(p*d+y*l)/h,n[s]=(y*d-p*l)/h;for(s=0;s<b;s++)p=o[s],y=i[s],o[s]=(p*d+y*l)/h,i[s]=(y*d-p*l)/h;for(s=u+1;s<b;s++){for(e=M[s],t=k[s],a=m[s],f=w[s],d=e[u],l=t[u],c=u+1;c<b;c++)p=r[c],y=n[c],e[c]-=p*d-y*l,t[c]-=y*d+p*l;for(c=0;c<b;c++)p=o[c],y=i[c],a[c]-=p*d-y*l,f[c]-=y*d+p*l}}for(u=b-1;u>0;u--)for(o=m[u],i=w[u],s=u-1;s>=0;s--)for(a=m[s],f=w[s],d=M[s][u],l=k[s][u],c=b-1;c>=0;c--)p=o[c],y=i[c],a[c]-=d*p-l*y,f[c]-=d*y+l*p;return new numeric.T(m,w)},numeric.T.prototype.get=function(r){var n,e=this.x,t=this.y,o=0,i=r.length;if(t){for(;o<i;)e=e[n=r[o]],t=t[n],o++;return new numeric.T(e,t)}for(;o<i;)e=e[n=r[o]],o++;return new numeric.T(e)},numeric.T.prototype.set=function(r,n){var e,t=this.x,o=this.y,i=0,a=r.length,f=n.x,u=n.y;if(0===a)return u?this.y=u:o&&(this.y=void 0),this.x=t,this;if(u){for(o||(o=numeric.rep(numeric.dim(t),0),this.y=o);i<a-1;)t=t[e=r[i]],o=o[e],i++;return t[e=r[i]]=f,o[e]=u,this}if(o){for(;i<a-1;)t=t[e=r[i]],o=o[e],i++;return t[e=r[i]]=f,f instanceof Array?o[e]=numeric.rep(numeric.dim(f),0):o[e]=0,this}for(;i<a-1;)t=t[e=r[i]],i++;return t[e=r[i]]=f,this},numeric.T.prototype.getRows=function(r,n){var e,t,o=n-r+1,i=Array(o),a=this.x,f=this.y;for(e=r;e<=n;e++)i[e-r]=a[e];if(f){for(t=Array(o),e=r;e<=n;e++)t[e-r]=f[e];return new numeric.T(i,t)}return new numeric.T(i)},numeric.T.prototype.setRows=function(r,n,e){var t,o=this.x,i=this.y,a=e.x,f=e.y;for(t=r;t<=n;t++)o[t]=a[t-r];if(f)for(i||(i=numeric.rep(numeric.dim(o),0),this.y=i),t=r;t<=n;t++)i[t]=f[t-r];else if(i)for(t=r;t<=n;t++)i[t]=numeric.rep([a[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,t=this.y,o=n.x,i=n.y;return e[r]=o,i?(t||(t=numeric.rep(numeric.dim(e),0),this.y=t),t[r]=i):t&&(t=numeric.rep([o.length],0)),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,t=this.y,o=numeric.getBlock;return t?new numeric.T(o(e,r,n),o(t,r,n)):new numeric.T(o(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var t=this.x,o=this.y,i=numeric.setBlock,a=e.x,f=e.y;if(f)return o||(this.y=numeric.rep(numeric.dim(this),0),o=this.y),i(t,r,n,a),i(o,r,n,f),this;i(t,r,n,a),o&&i(o,r,n,numeric.rep(numeric.dim(a),0))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var t=n.x,o=n.y,i=numeric.rep;return o?new e(i(r,t),i(r,o)):new e(i(r,t))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var n=r.x,e=r.y,t=numeric.diag;return e?new numeric.T(t(n),t(e)):new numeric.T(t(n))},numeric.T.eig=function(){if(this.y)throw Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=(r[0]>=0?1:-1)*numeric.norm2(r);n[0]+=e;var t=numeric.norm2(n);if(0===t)throw Error("eig: internal error");return numeric.div(n,t)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw Error("numeric: toUpperHessenberg() only works on square matrices");var e,t,o,i,a,f,u,s,c,h,x=n[0],d=numeric.clone(r),l=numeric.identity(x);for(t=0;t<x-2;t++){for(i=Array(x-t-1),e=t+1;e<x;e++)i[e-t-1]=d[e][t];if(numeric.norm2(i)>0){for(a=numeric.house(i),f=numeric.getBlock(d,[t+1,t],[x-1,x-1]),u=numeric.tensor(a,numeric.dot(a,f)),e=t+1;e<x;e++)for(s=d[e],c=u[e-t-1],o=t;o<x;o++)s[o]-=2*c[o-t];for(e=0,f=numeric.getBlock(d,[0,t+1],[x-1,x-1]),u=numeric.tensor(numeric.dot(f,a),a);e<x;e++)for(s=d[e],c=u[e],o=t+1;o<x;o++)s[o]-=2*c[o-t-1];for(f=Array(x-t-1),e=t+1;e<x;e++)f[e-t-1]=l[e];for(u=numeric.tensor(a,numeric.dot(a,f)),e=t+1;e<x;e++)for(o=0,h=l[e],c=u[e-t-1];o<x;o++)h[o]-=2*c[o]}}return{H:d,Q:l}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(r,n){void 0===n&&(n=1e4),r=numeric.clone(r),numeric.clone(r);var e,t,o,i,a,f,u,s,c,h,x,d,l,p,y,g,v,b,m=numeric.dim(r)[0],w=numeric.identity(m);if(m<3)return{Q:w,B:[[0,m-1]]};var M=numeric.epsilon;for(b=0;b<n;b++){for(g=0;g<m-1;g++)if(Math.abs(r[g+1][g])<M*(Math.abs(r[g][g])+Math.abs(r[g+1][g+1]))){var k,j,A,_=numeric.QRFrancis(numeric.getBlock(r,[0,0],[g,g]),n),S=numeric.QRFrancis(numeric.getBlock(r,[g+1,g+1],[m-1,m-1]),n);for(y=0,d=Array(g+1);y<=g;y++)d[y]=w[y];for(y=0,l=numeric.dot(_.Q,d);y<=g;y++)w[y]=l[y];for(d=Array(m-g-1),y=g+1;y<m;y++)d[y-g-1]=w[y];for(l=numeric.dot(S.Q,d),y=g+1;y<m;y++)w[y]=l[y-g-1];return{Q:w,B:_.B.concat(numeric.add(S.B,g+1))}}for(o=r[m-2][m-2],i=r[m-2][m-1],a=r[m-1][m-2],s=o+(f=r[m-1][m-1]),u=o*f-i*a,c=numeric.getBlock(r,[0,0],[2,2]),s*s>=4*u?(k=.5*(s+Math.sqrt(s*s-4*u)),j=.5*(s-Math.sqrt(s*s-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,k+j)),numeric.diag(numeric.rep([3],k*j)))):c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,s)),numeric.diag(numeric.rep([3],u))),e=[c[0][0],c[1][0],c[2][0]],t=numeric.house(e),d=[r[0],r[1],r[2]],l=numeric.tensor(t,numeric.dot(t,d)),y=0;y<3;y++)for(v=0,x=r[y],p=l[y];v<m;v++)x[v]-=2*p[v];for(y=0,d=numeric.getBlock(r,[0,0],[m-1,2]),l=numeric.tensor(numeric.dot(d,t),t);y<m;y++)for(v=0,x=r[y],p=l[y];v<3;v++)x[v]-=2*p[v];for(y=0,d=[w[0],w[1],w[2]],l=numeric.tensor(t,numeric.dot(t,d));y<3;y++)for(v=0,h=w[y],p=l[y];v<m;v++)h[v]-=2*p[v];for(g=0;g<m-2;g++){for(v=g;v<=g+1;v++)if(Math.abs(r[v+1][v])<M*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var _=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),n),S=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[m-1,m-1]),n);for(y=0,d=Array(v+1);y<=v;y++)d[y]=w[y];for(y=0,l=numeric.dot(_.Q,d);y<=v;y++)w[y]=l[y];for(d=Array(m-v-1),y=v+1;y<m;y++)d[y-v-1]=w[y];for(l=numeric.dot(S.Q,d),y=v+1;y<m;y++)w[y]=l[y-v-1];return{Q:w,B:_.B.concat(numeric.add(S.B,v+1))}}for(e=Array((A=Math.min(m-1,g+3))-g),y=g+1;y<=A;y++)e[y-g-1]=r[y][g];for(t=numeric.house(e),d=numeric.getBlock(r,[g+1,g],[A,m-1]),l=numeric.tensor(t,numeric.dot(t,d)),y=g+1;y<=A;y++)for(x=r[y],p=l[y-g-1],v=g;v<m;v++)x[v]-=2*p[v-g];for(y=0,d=numeric.getBlock(r,[0,g+1],[m-1,A]),l=numeric.tensor(numeric.dot(d,t),t);y<m;y++)for(x=r[y],p=l[y],v=g+1;v<=A;v++)x[v]-=2*p[v-g-1];for(d=Array(A-g),y=g+1;y<=A;y++)d[y-g-1]=w[y];for(l=numeric.tensor(t,numeric.dot(t,d)),y=g+1;y<=A;y++)for(v=0,h=w[y],p=l[y-g-1];v<m;v++)h[v]-=2*p[v]}}throw Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){var e,t,o,i,a,f,u,s,c,h,x,d,l,p,y,g,v=numeric.toUpperHessenberg(r),b=numeric.QRFrancis(v.H,n),m=numeric.T,w=r.length,M=b.B,k=numeric.dot(b.Q,numeric.dot(v.H,numeric.transpose(b.Q))),j=new m(numeric.dot(b.Q,v.Q)),A=M.length,_=Math.sqrt;for(p=0;p<A;p++)if((l=M[p][0])===M[p][1]);else{if(g=l+1,e=k[l][l],t=k[l][g],o=k[g][l],i=k[g][g],0===t&&0===o)continue;(f=(a=-e-i)*a-4*(e*i-t*o))>=0?((x=(e-(u=a<0?-.5*(a-_(f)):-.5*(a+_(f))))*(e-u)+t*t)>(d=o*o+(i-u)*(i-u))?(c=(e-u)/(x=_(x)),h=t/x):(c=o/(d=_(d)),h=(i-u)/d),y=new m([[h,-c],[c,h]])):(u=-.5*a,s=.5*_(-f),(x=(e-u)*(e-u)+t*t)>(d=o*o+(i-u)*(i-u))?(c=(e-u)/(x=_(x+s*s)),h=t/x,u=0,s/=x):(c=o/(d=_(d+s*s)),h=(i-u)/d,u=s/d,s=0),y=new m([[h,-c],[c,h]],[[u,s],[s,-u]])),j.setRows(l,g,y.dot(j.getRows(l,g)))}var S=j.dot(r).dot(j.transjugate()),w=r.length,V=numeric.T.identity(w);for(g=0;g<w;g++)if(g>0)for(p=g-1;p>=0;p--){var P=S.get([p,p]),q=S.get([g,g]);if(numeric.neq(P.x,q.x)||numeric.neq(P.y,q.y))u=S.getRow(p).getBlock([p],[g-1]),s=V.getRow(g).getBlock([p],[g-1]),V.set([g,p],S.get([p,g]).neg().sub(u.dot(s)).div(P.sub(q)));else{V.setRow(g,V.getRow(p));continue}}for(g=0;g<w;g++)u=V.getRow(g),V.setRow(g,u.div(u.norm2()));return V=V.transpose(),V=j.transjugate().dot(V),{lambda:S.getDiag(),E:V}},numeric.ccsSparse=function(r){var n,e,t,o,i=r.length,a=[];for(t=i-1;-1!==t;--t)for(o in e=r[t]){for(o=parseInt(o);o>=a.length;)a[a.length]=0;0!==e[o]&&a[o]++}var n=a.length,f=Array(n+1);for(t=0,f[0]=0;t<n;++t)f[t+1]=f[t]+a[t];var u=Array(f[n]),s=Array(f[n]);for(t=i-1;-1!==t;--t)for(o in e=r[t])0!==e[o]&&(a[o]--,u[f[o]+a[o]]=t,s[f[o]+a[o]]=e[o]);return[f,u,s]},numeric.ccsFull=function(r){var n,e,t,o,i=r[0],a=r[1],f=r[2],u=numeric.ccsDim(r),s=u[0],c=u[1],h=numeric.rep([s,c],0);for(n=0;n<c;n++)for(t=i[n],o=i[n+1],e=t;e<o;++e)h[a[e]][n]=f[e];return h},numeric.ccsTSolve=function(r,n,e,t,o){var i,a,f,u,s,c,h,x=r[0],d=r[1],l=r[2],p=x.length-1,y=Math.max,g=0;function v(r){var n;if(0===e[r]){for(e[r]=1,n=x[r];n<x[r+1];++n)v(d[n]);o[g]=r,++g}}for(void 0===t&&(e=numeric.rep([p],0)),void 0===t&&(t=numeric.linspace(0,e.length-1)),void 0===o&&(o=[]),i=t.length-1;-1!==i;--i)v(t[i]);for(o.length=g,i=o.length-1;-1!==i;--i)e[o[i]]=0;for(i=t.length-1;-1!==i;--i)e[a=t[i]]=n[a];for(i=o.length-1;-1!==i;--i){for(f=x[a=o[i]],u=y(x[a+1],f),s=f;s!==u;++s)if(d[s]===a){e[a]/=l[s];break}for(h=e[a],s=f;s!==u;++s)(c=d[s])!==a&&(e[c]-=h*l[s])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,t,o,i){var a,f,u,s=0,c=o.length,h=this.k,x=this.k1,d=this.j;if(0===t[r])for(t[r]=1,d[0]=r,h[0]=f=n[r],x[0]=u=n[r+1];;)if(f>=u){if(o[c]=d[s],0===s)return;++c,f=h[--s],u=x[s]}else 0===t[a=i[e[f]]]?(t[a]=1,h[s]=f,d[++s]=a,f=n[a],x[s]=u=n[a+1]):++f},numeric.ccsLPSolve=function(r,n,e,t,o,i,a){var f,u,s,c,h,x,d,l,p,y=r[0],g=r[1],v=r[2];y.length;var b=n[0],m=n[1],w=n[2];for(u=b[o],s=b[o+1],t.length=0,f=u;f<s;++f)a.dfs(i[m[f]],y,g,e,t,i);for(f=t.length-1;-1!==f;--f)e[t[f]]=0;for(f=u;f!==s;++f)e[c=i[m[f]]]=w[f];for(f=t.length-1;-1!==f;--f){for(h=y[c=t[f]],x=y[c+1],d=h;d<x;++d)if(i[g[d]]===c){e[c]/=v[d];break}for(p=e[c],d=h;d<x;++d)(l=i[g[d]])!==c&&(e[l]-=p*v[d])}return e},numeric.ccsLUP1=function(r,n){var e,t,o,i,a,f,u,s=r[0].length-1,c=[numeric.rep([s+1],0),[],[]],h=[numeric.rep([s+1],0),[],[]],x=c[0],d=c[1],l=c[2],p=h[0],y=h[1],g=h[2],v=numeric.rep([s],0),b=numeric.rep([s],0),m=numeric.ccsLPSolve,w=Math.abs,M=numeric.linspace(0,s-1),k=numeric.linspace(0,s-1),j=new numeric.ccsDFS(s);for(void 0===n&&(n=1),e=0;e<s;++e){for(m(c,r,v,b,e,k,j),i=-1,a=-1,t=b.length-1;-1!==t;--t)!((o=b[t])<=e)&&(f=w(v[o]))>i&&(a=o,i=f);for(w(v[e])<n*i&&(t=M[e],i=M[a],M[e]=i,k[i]=e,M[a]=t,k[t]=a,i=v[e],v[e]=v[a],v[a]=i),i=x[e],a=p[e],u=v[e],d[i]=M[e],l[i]=1,++i,t=b.length-1;-1!==t;--t)f=v[o=b[t]],b[t]=0,v[o]=0,o<=e?(y[a]=o,g[a]=f,++a):(d[i]=M[o],l[i]=f/u,++i);x[e+1]=i,p[e+1]=a}for(t=d.length-1;-1!==t;--t)d[t]=k[d[t]];return{L:c,U:h,P:M,Pinv:k}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,t,o,i,a){var f,u,s,c=0,h=o.length,x=this.k,d=this.k1,l=this.j;if(0===t[r])for(t[r]=1,l[0]=r,x[0]=u=n[i[r]],d[0]=s=n[i[r]+1];;){if(isNaN(u))throw Error("Ow!");if(u>=s){if(o[h]=i[l[c]],0===c)return;++h,u=x[--c],s=d[c]}else 0===t[f=e[u]]?(t[f]=1,x[c]=u,l[++c]=f,u=n[f=i[f]],d[c]=s=n[f+1]):++u}},numeric.ccsLPSolve0=function(r,n,e,t,o,i,a,f){var u,s,c,h,x,d,l,p,y,g=r[0],v=r[1],b=r[2];g.length;var m=n[0],w=n[1],M=n[2];for(s=m[o],c=m[o+1],t.length=0,u=s;u<c;++u)f.dfs(w[u],g,v,e,t,i,a);for(u=t.length-1;-1!==u;--u)e[a[h=t[u]]]=0;for(u=s;u!==c;++u)e[h=w[u]]=M[u];for(u=t.length-1;-1!==u;--u){for(p=a[h=t[u]],x=g[h],d=g[h+1],l=x;l<d;++l)if(v[l]===p){e[p]/=b[l];break}for(y=e[p],l=x;l<d;++l)e[v[l]]-=y*b[l];e[p]=y}},numeric.ccsLUP0=function(r,n){var e,t,o,i,a,f,u,s=r[0].length-1,c=[numeric.rep([s+1],0),[],[]],h=[numeric.rep([s+1],0),[],[]],x=c[0],d=c[1],l=c[2],p=h[0],y=h[1],g=h[2],v=numeric.rep([s],0),b=numeric.rep([s],0),m=numeric.ccsLPSolve0,w=Math.abs,M=numeric.linspace(0,s-1),k=numeric.linspace(0,s-1),j=new numeric.ccsDFS0(s);for(void 0===n&&(n=1),e=0;e<s;++e){for(m(c,r,v,b,e,k,M,j),i=-1,a=-1,t=b.length-1;-1!==t;--t)!((o=b[t])<=e)&&(f=w(v[M[o]]))>i&&(a=o,i=f);for(w(v[M[e]])<n*i&&(t=M[e],i=M[a],M[e]=i,k[i]=e,M[a]=t,k[t]=a),i=x[e],a=p[e],u=v[M[e]],d[i]=M[e],l[i]=1,++i,t=b.length-1;-1!==t;--t)f=v[M[o=b[t]]],b[t]=0,v[M[o]]=0,o<=e?(y[a]=o,g[a]=f,++a):(d[i]=M[o],l[i]=f/u,++i);x[e+1]=i,p[e+1]=a}for(t=d.length-1;-1!==t;--t)d[t]=k[d[t]];return{L:c,U:h,P:M,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var t=numeric.ccsDim(r),o=t[0],i=t[1];void 0===n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]),void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]);var a,f,u,s,c=n.length,h=e.length,x=numeric.rep([i],0),d=[],l=[],p=[x,d,l],y=r[0],g=r[1],v=r[2],b=numeric.rep([o],0),m=0,w=numeric.rep([o],0);for(f=0;f<h;++f){var M=y[s=e[f]],k=y[s+1];for(a=M;a<k;++a)w[u=g[a]]=1,b[u]=v[a];for(a=0;a<c;++a)w[n[a]]&&(d[m]=a,l[m]=b[n[a]],++m);for(a=M;a<k;++a)w[u=g[a]]=0;x[f+1]=m}return p},numeric.ccsDot=function(r,n){var e,t,o,i,a,f,u,s,c,h,x,d=r[0],l=r[1],p=r[2],y=n[0],g=n[1],v=n[2],b=numeric.ccsDim(r),m=numeric.ccsDim(n),w=b[0],M=(b[1],m[1]),k=numeric.rep([w],0),j=numeric.rep([w],0),A=Array(w),_=numeric.rep([M],0),S=[],V=[],P=[_,S,V];for(o=0;o!==M;++o){for(i=y[o],a=y[o+1],c=0,t=i;t<a;++t)for(h=g[t],x=v[t],f=d[h],u=d[h+1],e=f;e<u;++e)0===j[s=l[e]]&&(A[c]=s,j[s]=1,c+=1),k[s]=k[s]+p[e]*x;for(a=(i=_[o])+c,_[o+1]=a,t=c-1;-1!==t;--t)x=i+t,e=A[t],S[x]=e,V[x]=k[e],j[e]=0,k[e]=0;_[o+1]=_[o]+c}return P},numeric.ccsLUPSolve=function(r,n){var e=r.L,t=r.U;r.P;var o=n[0],i=!1;"object"!=typeof o&&(o=(n=[[0,n.length],numeric.linspace(0,n.length-1),n])[0],i=!0);var a,f,u,s,c,h,x=n[1],d=n[2],l=e[0].length-1,p=o.length-1,y=numeric.rep([l],0),g=Array(l),v=numeric.rep([l],0),b=Array(l),m=numeric.rep([p+1],0),w=[],M=[],k=numeric.ccsTSolve,j=0;for(a=0;a<p;++a){for(c=0,u=o[a],s=o[a+1],f=u;f<s;++f)h=r.Pinv[x[f]],b[c]=h,v[h]=d[f],++c;for(b.length=c,k(e,v,y,b,g),f=b.length-1;-1!==f;--f)v[b[f]]=0;if(k(t,y,v,g,b),i)return v;for(f=g.length-1;-1!==f;--f)y[g[f]]=0;for(f=b.length-1;-1!==f;--f)h=b[f],w[j]=h,M[j]=v[h],v[h]=0,++j;m[a+1]=j}return[m,w,M]},numeric.ccsbinop=function(r,n){return void 0===n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var n,e=r[0],t=r[1],o=r[2],i=numeric.sup(t)+1,a=e.length,f=numeric.rep([i],0),u=Array(a),s=Array(a),c=numeric.rep([i],0);for(n=0;n<a;++n)c[t[n]]++;for(n=0;n<i;++n)f[n+1]=f[n]+c[n];var h,x,d=f.slice(0);for(n=0;n<a;++n)u[h=d[x=t[n]]]=e[n],s[h]=o[n],d[x]=d[x]+1;return[f,u,s]},numeric.ccsGather=function(r){var n,e,t,o,i,a=r[0],f=r[1],u=r[2],s=a.length-1,c=f.length,h=Array(c),x=Array(c),d=Array(c);for(n=0,i=0;n<s;++n)for(t=a[n],o=a[n+1],e=t;e!==o;++e)x[i]=n,h[i]=f[e],d[i]=u[e],++i;return[h,x,d]},numeric.sdim=function r(n,e,t){var o;if(void 0===e&&(e=[]),"object"!=typeof n)return e;for(o in void 0===t&&(t=0),t in e||(e[t]=0),n.length>e[t]&&(e[t]=n.length),n)n.hasOwnProperty(o)&&r(n[o],e,t+1);return e},numeric.sclone=function r(n,e,t){void 0===e&&(e=0),void 0===t&&(t=numeric.sdim(n).length);var o,i=Array(n.length);if(e===t-1){for(o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);return i}for(o in n)n.hasOwnProperty(o)&&(i[o]=r(n[o],e+1,t));return i},numeric.sdiag=function(r){var n,e,t=r.length,o=Array(t);for(n=t-1;n>=1;n-=2)e=n-1,o[n]=[],o[n][n]=r[n],o[e]=[],o[e][e]=r[e];return 0===n&&(o[0]=[],o[0][0]=r[n]),o},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var n,e,t,o=[];for(n in r.length,r)if(r.hasOwnProperty(n))for(e in t=r[n])t.hasOwnProperty(e)&&("object"!=typeof o[e]&&(o[e]=[]),o[e][n]=t[e]);return o},numeric.sLUP=function(r,n){throw Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){var e,t,o,i,a,f,u,s=r.length,c=(n.length,numeric.stranspose(n)),h=c.length,x=Array(s);for(o=s-1;o>=0;o--){for(u=[],e=r[o],a=h-1;a>=0;a--){for(i in f=0,t=c[a],e)e.hasOwnProperty(i)&&i in t&&(f+=e[i]*t[i]);f&&(u[a]=f)}x[o]=u}return x},numeric.sdotMV=function(r,n){var e,t,o,i,a=r.length,f=Array(a);for(t=a-1;t>=0;t--){for(o in e=r[t],i=0,e)e.hasOwnProperty(o)&&n[o]&&(i+=e[o]*n[o]);i&&(f[t]=i)}return f},numeric.sdotVM=function(r,n){var e,t,o,i,a=[];for(e in r)if(r.hasOwnProperty(e))for(t in o=n[e],i=r[e],o)o.hasOwnProperty(t)&&(a[t]||(a[t]=0),a[t]+=i*o[t]);return a},numeric.sdotVV=function(r,n){var e,t=0;for(e in r)r[e]&&n[e]&&(t+=r[e]*n[e]);return t},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,t=numeric.sdim(n).length;switch(1e3*e+t){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw Error("numeric.sdot not implemented for tensors of order "+e+" and "+t)}},numeric.sscatter=function(r){var n,e,t,o,i=r[0].length,a=r.length,f=[];for(e=i-1;e>=0;--e)if(r[a-1][e]){for(t=0,o=f;t<a-2;t++)o[n=r[t][e]]||(o[n]=[]),o=o[n];o[r[t][e]]=r[t+1][e]}return f},numeric.sgather=function r(n,e,t){var o,i,a;for(i in void 0===e&&(e=[]),void 0===t&&(t=[]),o=t.length,n)if(n.hasOwnProperty(i))if(t[o]=parseInt(i),"number"==typeof(a=n[i])){if(a){if(0===e.length)for(i=o+1;i>=0;--i)e[i]=[];for(i=o;i>=0;--i)e[i].push(t[i]);e[o+1].push(a)}}else r(a,e,t);return t.length>o&&t.pop(),e},numeric.cLU=function(r){var n,e,t,o,i,a,f,u,s,c,h,x,d=r[0],l=r[1],p=r[2],o=d.length,y=0;for(f=0;f<o;f++)d[f]>y&&(y=d[f]);var g=Array(++y),v=Array(y),b=numeric.rep([y],1/0),m=numeric.rep([y],-1/0);for(s=0;s<o;s++)f=d[s],(u=l[s])<b[f]&&(b[f]=u),u>m[f]&&(m[f]=u);for(f=0;f<y-1;f++)m[f]>m[f+1]&&(m[f+1]=m[f]);for(f=y-1;f>=1;f--)b[f]<b[f-1]&&(b[f-1]=b[f]);var w=0,M=0;for(f=0;f<y;f++)v[f]=numeric.rep([m[f]-b[f]+1],0),g[f]=numeric.rep([f-b[f]],0),w+=f-b[f]+1,M+=m[f]-f+1;for(s=0;s<o;s++)v[f=d[s]][l[s]-b[f]]=p[s];for(f=0;f<y-1;f++)for(c=f-b[f],n=v[f],u=f+1;b[u]<=f&&u<y;u++)if(h=f-b[u],x=m[f]-f,t=(e=v[u])[h]/n[c]){for(s=1;s<=x;s++)e[s+h]-=t*n[s+c];g[u][f-b[u]]=t}var n=[],e=[],k=[],j=[],A=[],_=[];for(f=0,o=0,i=0;f<y;f++){for(c=b[f],h=m[f],a=v[f],u=f;u<=h;u++)a[u-c]&&(n[o]=f,e[o]=u,k[o]=a[u-c],o++);for(a=g[f],u=c;u<f;u++)a[u-c]&&(j[i]=f,A[i]=u,_[i]=a[u-c],i++);j[i]=f,A[i]=f,_[i]=1,i++}return{U:[n,e,k],L:[j,A,_]}},numeric.cLUsolve=function(r,n){var e=r.L,t=r.U,o=numeric.clone(n),i=e[0],a=e[1],f=e[2],u=t[0],s=t[1],c=t[2],h=u.length;i.length;var x,d,l=o.length;for(x=0,d=0;x<l;x++){for(;a[d]<x;)o[x]-=f[d]*o[a[d]],d++;d++}for(d=h-1,x=l-1;x>=0;x--){for(;s[d]>x;)o[x]-=c[d]*o[s[d]],d--;o[x]/=c[d],d--}return o},numeric.cgrid=function(r,n){"number"==typeof r&&(r=[r,r]);var e,t,o,i=numeric.rep(r,-1);for("function"!=typeof n&&(n="L"===n?function(n,e){return n>=r[0]/2||e<r[1]/2}:function(r,n){return!0}),o=0,e=1;e<r[0]-1;e++)for(t=1;t<r[1]-1;t++)n(e,t)&&(i[e][t]=o,o++);return i},numeric.cdelsq=function(r){var n,e,t,o,i,a=[[-1,0],[0,-1],[0,1],[1,0]],f=numeric.dim(r),u=f[0],s=f[1],c=[],h=[],x=[];for(n=1;n<u-1;n++)for(e=1;e<s-1;e++)if(!(r[n][e]<0)){for(t=0;t<4;t++)o=n+a[t][0],i=e+a[t][1],r[o][i]<0||(c.push(r[n][e]),h.push(r[o][i]),x.push(-1));c.push(r[n][e]),h.push(r[n][e]),x.push(4)}return[c,h,x]},numeric.cdotMV=function(r,n){var e,t,o,i=r[0],a=r[1],f=r[2],u=i.length;for(t=0,o=0;t<u;t++)i[t]>o&&(o=i[t]);for(o++,e=numeric.rep([o],0),t=0;t<u;t++)e[i[t]]+=f[t]*n[a[t]];return e},numeric.Spline=function(r,n,e,t,o){this.x=r,this.yl=n,this.yr=e,this.kl=t,this.kr=o},numeric.Spline.prototype._at=function(r,n){var e,t,o,i=this.x,a=this.yl,f=this.yr,u=this.kl,s=this.kr,c=numeric.add,h=numeric.sub,x=numeric.mul;e=h(x(u[n],i[n+1]-i[n]),h(f[n+1],a[n])),t=c(x(s[n+1],i[n]-i[n+1]),h(f[n+1],a[n]));var d=(o=(r-i[n])/(i[n+1]-i[n]))*(1-o);return c(c(c(x(1-o,a[n]),x(o,f[n+1])),x(e,d*(1-o))),x(t,d*o))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var n,e,t,o=this.x,i=o.length,a=Math.floor;for(n=0,e=i-1;e-n>1;)o[t=a((n+e)/2)]<=r?n=t:e=t;return this._at(r,n)}var f,i=r.length,u=Array(i);for(f=i-1;-1!==f;--f)u[f]=this.at(r[f]);return u},numeric.Spline.prototype.diff=function(){var r,n,e,t=this.x,o=this.yl,i=this.yr,a=this.kl,f=this.kr,u=o.length,s=a,c=f,h=Array(u),x=Array(u),d=numeric.add,l=numeric.mul,p=numeric.div,y=numeric.sub;for(r=u-1;-1!==r;--r)n=t[r+1]-t[r],e=y(i[r+1],o[r]),h[r]=p(d(l(e,6),l(a[r],-4*n),l(f[r+1],-2*n)),n*n),x[r+1]=p(d(l(e,-6),l(a[r],2*n),l(f[r+1],4*n)),n*n);return new numeric.Spline(t,s,c,h,x)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var n=[],e=this.x,t=this.yl,o=this.yr,i=this.kl,a=this.kr;"number"==typeof t[0]&&(t=[t],o=[o],i=[i],a=[a]);var f,u,s,c,h,x,d,l,p,y,g,v,b,m,w,M,k,j,A,_,S,V,P,q,F=t.length,L=e.length-1,n=Array(F),N=Math.sqrt;for(f=0;f!==F;++f){for(u=0,c=t[f],h=o[f],x=i[f],d=a[f],l=[];u!==L;u++){for(u>0&&h[u]*c[u]<0&&l.push(e[u]),M=e[u+1]-e[u],k=e[u],g=c[u],v=h[u+1],w=r((p=x[u]/M)-(y=d[u+1]/M)+3*(g-v))+12*y*g,b=y+3*g+2*p-3*v,m=3*(y+p+2*(g-v)),w<=0?j=(A=b/m)>e[u]&&A<e[u+1]?[e[u],A,e[u+1]]:[e[u],e[u+1]]:(A=(b-N(w))/m,_=(b+N(w))/m,j=[e[u]],A>e[u]&&A<e[u+1]&&j.push(A),_>e[u]&&_<e[u+1]&&j.push(_),j.push(e[u+1])),V=j[0],A=this._at(V,u),s=0;s<j.length-1;s++){if(P=j[s+1],_=this._at(P,u),0===A){l.push(V),V=P,A=_;continue}if(0===_||A*_>0){V=P,A=_;continue}for(var O=0;!((q=(A*P-_*V)/(A-_))<=V)&&!(q>=P);)if((S=this._at(q,u))*_>0)P=q,_=S,-1===O&&(A*=.5),O=-1;else if(S*A>0)V=q,A=S,1===O&&(_*=.5),O=1;else break;l.push(q),V=j[s+1],A=this._at(V,u)}0===_&&l.push(P)}n[f]=l}return"number"==typeof this.yl[0]?n[0]:n},numeric.spline=function(r,n,e,t){var o,i=r.length,a=[],f=[],u=[],s=numeric.sub,c=numeric.mul,h=numeric.add;for(o=i-2;o>=0;o--)f[o]=r[o+1]-r[o],u[o]=s(n[o+1],n[o]);("string"==typeof e||"string"==typeof t)&&(e=t="periodic");var x=[[],[],[]];switch(typeof e){case"undefined":a[0]=c(3/(f[0]*f[0]),u[0]),x[0].push(0,0),x[1].push(0,1),x[2].push(2/f[0],1/f[0]);break;case"string":a[0]=h(c(3/(f[i-2]*f[i-2]),u[i-2]),c(3/(f[0]*f[0]),u[0])),x[0].push(0,0,0),x[1].push(i-2,0,1),x[2].push(1/f[i-2],2/f[i-2]+2/f[0],1/f[0]);break;default:a[0]=e,x[0].push(0),x[1].push(0),x[2].push(1)}for(o=1;o<i-1;o++)a[o]=h(c(3/(f[o-1]*f[o-1]),u[o-1]),c(3/(f[o]*f[o]),u[o])),x[0].push(o,o,o),x[1].push(o-1,o,o+1),x[2].push(1/f[o-1],2/f[o-1]+2/f[o],1/f[o]);switch(typeof t){case"undefined":a[i-1]=c(3/(f[i-2]*f[i-2]),u[i-2]),x[0].push(i-1,i-1),x[1].push(i-2,i-1),x[2].push(1/f[i-2],2/f[i-2]);break;case"string":x[1][x[1].length-1]=0;break;default:a[i-1]=t,x[0].push(i-1),x[1].push(i-1),x[2].push(1)}var d=Array((a="number"!=typeof a[0]?numeric.transpose(a):[a]).length);if("string"==typeof e)for(o=d.length-1;-1!==o;--o)d[o]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(x)),a[o]),d[o][i-1]=d[o][0];else for(o=d.length-1;-1!==o;--o)d[o]=numeric.cLUsolve(numeric.cLU(x),a[o]);return d="number"==typeof n[0]?d[0]:numeric.transpose(d),new numeric.Spline(r,n,n,d,d)},numeric.fftpow2=function r(n,e){var t=n.length;if(1!==t){var o,i,a=Math.cos,f=Math.sin,u=Array(t/2),s=Array(t/2),c=Array(t/2),h=Array(t/2);for(i=t/2,o=t-1;-1!==o;--o)c[--i]=n[o],h[i]=e[o],--o,u[i]=n[o],s[i]=e[o];r(u,s),r(c,h),i=t/2;var x,d,l,p=-6.283185307179586/t;for(o=t-1;-1!==o;--o)-1==--i&&(i=t/2-1),d=a(x=p*o),l=f(x),n[o]=u[i]+d*c[i]-l*h[i],e[o]=s[i]+d*h[i]+l*c[i]}},numeric._ifftpow2=function r(n,e){var t=n.length;if(1!==t){var o,i,a=Math.cos,f=Math.sin,u=Array(t/2),s=Array(t/2),c=Array(t/2),h=Array(t/2);for(i=t/2,o=t-1;-1!==o;--o)c[--i]=n[o],h[i]=e[o],--o,u[i]=n[o],s[i]=e[o];r(u,s),r(c,h),i=t/2;var x,d,l,p=6.283185307179586/t;for(o=t-1;-1!==o;--o)-1==--i&&(i=t/2-1),d=a(x=p*o),l=f(x),n[o]=u[i]+d*c[i]-l*h[i],e[o]=s[i]+d*h[i]+l*c[i]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,t){var o,i,a,f,u;for(numeric.fftpow2(r,n),numeric.fftpow2(e,t),o=r.length-1;-1!==o;--o)i=r[o],f=n[o],a=e[o],u=t[o],r[o]=i*a-f*u,n[o]=i*u+f*a;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){var r,n,e=this.x,t=this.y,o=e.length,i=Math.log,a=i(2),f=Math.pow(2,Math.ceil(i(2*o-1)/a)),u=numeric.rep([f],0),s=numeric.rep([f],0),c=Math.cos,h=Math.sin,x=-3.141592653589793/o,d=numeric.rep([f],0),l=numeric.rep([f],0);for(r=0;r<o;r++)d[r]=e[r];if(void 0!==t)for(r=0;r<o;r++)l[r]=t[r];for(r=1,u[0]=1;r<=f/2;r++)n=x*r*r,u[r]=c(n),s[r]=h(n),u[f-r]=c(n),s[f-r]=h(n);var p=new numeric.T(d,l),y=new numeric.T(u,s);return p=p.mul(y),numeric.convpow2(p.x,p.y,numeric.clone(y.x),numeric.neg(y.y)),(p=p.mul(y)).x.length=o,p.y.length=o,p},numeric.T.prototype.ifft=function(){var r,n,e=this.x,t=this.y,o=e.length,i=Math.log,a=i(2),f=Math.pow(2,Math.ceil(i(2*o-1)/a)),u=numeric.rep([f],0),s=numeric.rep([f],0),c=Math.cos,h=Math.sin,x=3.141592653589793/o,d=numeric.rep([f],0),l=numeric.rep([f],0);for(r=0;r<o;r++)d[r]=e[r];if(void 0!==t)for(r=0;r<o;r++)l[r]=t[r];for(r=1,u[0]=1;r<=f/2;r++)n=x*r*r,u[r]=c(n),s[r]=h(n),u[f-r]=c(n),s[f-r]=h(n);var p=new numeric.T(d,l),y=new numeric.T(u,s);return p=p.mul(y),numeric.convpow2(p.x,p.y,numeric.clone(y.x),numeric.neg(y.y)),(p=p.mul(y)).x.length=o,p.y.length=o,p.div(o)},numeric.gradient=function(r,n){var e=n.length,t=r(n);if(isNaN(t))throw Error("gradient: f(x) is a NaN!");var o,i,a,f=Math.max,u=numeric.clone(n),s=Array(e);numeric.div,numeric.sub;var c,h,x,d,l,p,f=Math.max,y=.001,g=Math.abs,v=Math.min,b=0;for(o=0;o<e;o++)for(var m=f(1e-6*t,1e-8);;){if(++b>20)throw Error("Numerical gradient fails");if(u[o]=n[o]+m,i=r(u),u[o]=n[o]-m,a=r(u),u[o]=n[o],isNaN(i)||isNaN(a)){m/=16;continue}if(s[o]=(i-a)/(2*m),c=n[o]-m,h=n[o],x=n[o]+m,d=(i-t)/m,l=(t-a)/m,p=f(g(s[o]),g(t),g(i),g(a),g(c),g(h),g(x),1e-8),v(f(g(d-s[o]),g(l-s[o]),g(d-l))/p,m/p)>y)m/=16;else break}return s},numeric.uncmin=function(r,n,e,t,o,i,a){var f=numeric.gradient;void 0===a&&(a={}),void 0===e&&(e=1e-8),void 0===t&&(t=function(n){return f(r,n)}),void 0===o&&(o=1e3);var u,s,c=(n=numeric.clone(n)).length,h=r(n);if(isNaN(h))throw Error("uncmin: f(x0) is a NaN!");var x=Math.max,d=numeric.norm2;e=x(e,numeric.epsilon);var l,p,y,g,v,b,m,w,M,k,j=a.Hinv||numeric.identity(c),A=numeric.dot,_=(numeric.inv,numeric.sub),S=numeric.add,V=numeric.tensor,P=numeric.div,q=numeric.mul,F=numeric.all,L=numeric.isFinite,N=numeric.neg,O=0,U="";for(p=t(n);O<o;){if("function"==typeof i&&i(O,n,h,p,j)){U="Callback returned true";break}if(!F(L(p))){U="Gradient has Infinity or NaN";break}if(!F(L(l=N(A(j,p))))){U="Search direction has Infinity or NaN";break}if((k=d(l))<e){U="Newton step smaller than tol";break}for(M=1,s=A(p,l),v=n;O<o&&!(M*k<e);){if((u=r(v=S(n,g=q(l,M))))-h>=.1*M*s||isNaN(u)){M*=.5,++O;continue}break}if(M*k<e){U="Line search step size smaller than tol";break}if(O===o){U="maxit reached during line search";break}w=A(b=_(y=t(v),p),g),m=A(j,b),j=_(S(j,q((w+A(b,m))/(w*w),V(g,g))),P(S(V(m,g),V(g,m)),w)),n=v,h=u,p=y,++O}return{solution:n,f:h,gradient:p,invHessian:j,iterations:O,message:U}},numeric.Dopri=function(r,n,e,t,o,i,a){this.x=r,this.y=n,this.f=e,this.ymid=t,this.iterations=o,this.events=a,this.message=i},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var t=this,o=t.x,i=t.y,a=t.f,f=t.ymid;o.length;var u,s,c,h,x,d,l,p,y,g,v=.5,b=numeric.add,m=numeric.mul,w=numeric.sub;return u=o[n],s=o[n+1],h=i[n],x=i[n+1],l=s-u,c=u+v*l,d=f[n],p=w(a[n],m(h,1/(u-c)+2/(u-s))),y=w(a[n+1],m(x,1/(s-c)+2/(s-u))),b(b(b(b(m(h,(g=[e(r-s)*(r-c)/e(u-s)/(u-c),e(r-u)*e(r-s)/e(u-c)/e(s-c),e(r-u)*(r-c)/e(s-u)/(s-c),(r-u)*e(r-s)*(r-c)/e(u-s)/(u-c),(r-s)*e(r-u)*(r-c)/e(u-s)/(s-c)])[0]),m(d,g[1])),m(x,g[2])),m(p,g[3])),m(y,g[4]))},numeric.Dopri.prototype.at=function(r){var n,e,t,o=Math.floor;if("number"!=typeof r){var i=r.length,a=Array(i);for(n=i-1;-1!==n;--n)a[n]=this.at(r[n]);return a}var f=this.x;for(n=0,e=f.length-1;e-n>1;)f[t=o(.5*(n+e))]<=r?n=t:e=t;return this._at(r,n)},numeric.dopri=function(r,n,e,t,o,i,a){void 0===o&&(o=1e-6),void 0===i&&(i=1e3);var f,u,s,c,h,x,d,l,p,y,g=[r],v=[e],b=[t(r,e)],m=[],w=.2,M=[3/40,9/40],k=[44/45,-56/15,32/9],j=[19372/6561,-25360/2187,64448/6561,-212/729],A=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],_=[35/384,0,500/1113,125/192,-2187/6784,11/84],S=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],V=[.2,.3,.8,8/9,1,1],P=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],q=0,F=(n-r)/10,L=0,N=numeric.add,O=numeric.mul,U=Math.min,D=Math.abs,B=numeric.norminf,X=Math.pow,R=numeric.any,E=numeric.lt,Y=numeric.and;numeric.sub;var I=new numeric.Dopri(g,v,b,m,-1,"");for("function"==typeof a&&(Q=a(r,e));r<n&&L<i;){if(++L,r+F>n&&(F=n-r),f=t(r+V[0]*F,N(e,O(w*F,b[q]))),u=t(r+V[1]*F,N(N(e,O(M[0]*F,b[q])),O(M[1]*F,f))),s=t(r+V[2]*F,N(N(N(e,O(k[0]*F,b[q])),O(k[1]*F,f)),O(k[2]*F,u))),c=t(r+V[3]*F,N(N(N(N(e,O(j[0]*F,b[q])),O(j[1]*F,f)),O(j[2]*F,u)),O(j[3]*F,s))),h=t(r+V[4]*F,N(N(N(N(N(e,O(A[0]*F,b[q])),O(A[1]*F,f)),O(A[2]*F,u)),O(A[3]*F,s)),O(A[4]*F,c))),p=N(N(N(N(N(e,O(b[q],F*_[0])),O(u,F*_[2])),O(s,F*_[3])),O(c,F*_[4])),O(h,F*_[5])),x=t(r+F,p),(y="number"==typeof(d=N(N(N(N(N(O(b[q],F*P[0]),O(u,F*P[2])),O(s,F*P[3])),O(c,F*P[4])),O(h,F*P[5])),O(x,F*P[6])))?D(d):B(d))>o){if(r+(F=.2*F*X(o/y,.25))===r){I.msg="Step size became too small";break}continue}if(m[q]=N(N(N(N(N(N(e,O(b[q],F*S[0])),O(u,F*S[2])),O(s,F*S[3])),O(c,F*S[4])),O(h,F*S[5])),O(x,F*S[6])),g[++q]=r+F,v[q]=p,b[q]=x,"function"==typeof a){var Q,Z,C,H,z,G=r,$=r+.5*F;if(Z=a($,m[q-1]),R(C=Y(E(Q,0),E(0,Z)))||(G=$,$=r+F,Q=Z,Z=a($,p),C=Y(E(Q,0),E(0,Z))),R(C)){for(var W,J,K=0,rr=1,rn=1;;){if("number"==typeof Q)z=(rn*Z*G-rr*Q*$)/(rn*Z-rr*Q);else for(z=$,l=Q.length-1;-1!==l;--l)Q[l]<0&&Z[l]>0&&(z=U(z,(rn*Z[l]*G-rr*Q[l]*$)/(rn*Z[l]-rr*Q[l])));if(z<=G||z>=$)break;H=I._at(z,q-1),J=a(z,H),R(W=Y(E(Q,0),E(0,J)))?($=z,Z=J,C=W,rn=1,-1===K?rr*=.5:rr=1,K=-1):(G=z,Q=J,rr=1,1===K?rn*=.5:rn=1,K=1)}return p=I._at(.5*(r+z),q-1),I.f[q]=t(z,H),I.x[q]=z,I.y[q]=H,I.ymid[q-1]=p,I.events=C,I.iterations=L,I}}r+=F,e=p,Q=Z,F=U(.8*F*X(o/y,.25),4*F)}return I.iterations=L,I},numeric.LU=function(r,n){n=n||!1;var e,t,o,i,a,f,u,s,c,h=Math.abs,x=r.length,d=x-1,l=Array(x);for(n||(r=numeric.clone(r)),o=0;o<x;++o){for(u=o,c=h((f=r[o])[o]),t=o+1;t<x;++t)c<(i=h(r[t][o]))&&(c=i,u=t);for(l[o]=u,u!=o&&(r[o]=r[u],r[u]=f,f=r[o]),a=f[o],e=o+1;e<x;++e)r[e][o]/=a;for(e=o+1;e<x;++e){for(s=r[e],t=o+1;t<d;++t)s[t]-=s[o]*f[t],++t,s[t]-=s[o]*f[t];t===d&&(s[t]-=s[o]*f[t])}}return{LU:r,P:l}},numeric.LUsolve=function(r,n){var e,t,o,i,a,f=r.LU,u=f.length,s=numeric.clone(n),c=r.P;for(e=u-1;-1!==e;--e)s[e]=n[e];for(e=0;e<u;++e)for(o=c[e],c[e]!==e&&(a=s[e],s[e]=s[o],s[o]=a),i=f[e],t=0;t<e;++t)s[e]-=s[t]*i[t];for(e=u-1;e>=0;--e){for(i=f[e],t=e+1;t<u;++t)s[e]-=s[t]*i[t];s[e]/=i[e]}return s},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var n,e,t,o,i,a,f,u,s=numeric.dim(r),c=s[0],h=s[1],x=numeric.identity(c),d=Array(c),l=Math.abs,p=numeric.diveq;for(n=0,r=numeric.clone(r);n<c;++n){for(e=1,t=0,i=r[n],a=x[n];e<h;++e)l(i[t])<l(i[e])&&(t=e);for(d[n]=t,p(a,i[t]),p(i,i[t]),e=0;e<c;++e)if(e!==n){for(u=(f=r[e])[t],o=h-1;-1!==o;--o)f[o]-=i[o]*u;for(f=x[e],o=c-1;-1!==o;--o)f[o]-=a[o]*u}}return{I:x,A:r,P:d}},numeric.__solveLP=function(r,n,e,t,o,i,a){var f,u=numeric.sum,s=(numeric.log,numeric.mul),c=numeric.sub,h=numeric.dot,x=numeric.div,d=numeric.add,l=r.length,p=e.length,y=!1,g=0,v=1;numeric.transpose(n),numeric.svd;var b=numeric.transpose,m=(numeric.leq,Math.sqrt),w=Math.abs;numeric.muleq,numeric.norminf,numeric.any;var M,k=Math.min,j=numeric.all,A=numeric.gt,_=Array(l),S=Array(p);numeric.rep([p],1);var V,P=numeric.solve,q=c(e,h(n,i)),F=h(r,r);for(V=g;V<o;++V){for(N=p-1;-1!==N;--N)S[N]=x(n[N],q[N]);var L,N,O,U=b(S);for(N=l-1;-1!==N;--N)_[N]=u(U[N]);v=.25*w(F/h(r,_));var D=100*m(F/h(_,_));for((!isFinite(v)||v>D)&&(v=D),L=d(r,s(v,_)),M=h(U,S),N=l-1;-1!==N;--N)M[N][N]+=1;O=P(M,x(L,v),!0);var B=x(q,h(n,O)),X=1;for(N=p-1;-1!==N;--N)B[N]<0&&(X=k(X,-.999*B[N]));if(f=c(i,s(O,X)),!j(A(q=c(e,h(n,f)),0)))return{solution:i,message:"",iterations:V};if(i=f,v<t)return{solution:f,message:"",iterations:V};if(a){var R=h(r,L),E=h(n,L);for(y=!0,N=p-1;-1!==N;--N)if(R*E[N]<0){y=!1;break}}else y=!(i[l-1]>=0);if(y)return{solution:f,message:"Unbounded",iterations:V}}return{solution:i,message:"maximum iteration count exceeded",iterations:V}},numeric._solveLP=function(r,n,e,t,o){var i,a=r.length,f=e.length;numeric.sum,numeric.log,numeric.mul;var u=numeric.sub,s=numeric.dot;numeric.div,numeric.add;var c=numeric.rep([a],0).concat([1]),h=numeric.rep([f,1],-1),x=numeric.blockMatrix([[n,h]]),d=e,i=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),l=numeric.__solveLP(c,x,d,t,o,i,!1),p=numeric.clone(l.solution);if(p.length=a,0>numeric.inf(u(e,s(n,p))))return{solution:NaN,message:"Infeasible",iterations:l.iterations};var y=numeric.__solveLP(r,n,e,t,o-l.iterations,p,!0);return y.iterations+=l.iterations,y},numeric.solveLP=function(r,n,e,t,o,i,a){if(void 0===a&&(a=1e3),void 0===i&&(i=numeric.epsilon),void 0===t)return numeric._solveLP(r,n,e,i,a);var f,u=t.length,s=t[0].length,c=n.length,h=numeric.echelonize(t),x=numeric.rep([s],0),d=h.P,l=[];for(f=d.length-1;-1!==f;--f)x[d[f]]=1;for(f=s-1;-1!==f;--f)0===x[f]&&l.push(f);var p=numeric.getRange,y=numeric.linspace(0,u-1),g=numeric.linspace(0,c-1),v=p(t,y,l),b=p(n,g,d),m=p(n,g,l),w=numeric.dot,M=numeric.sub,k=w(b,h.I),j=M(m,w(k,v)),A=M(e,w(k,o)),_=Array(d.length),S=Array(l.length);for(f=d.length-1;-1!==f;--f)_[f]=r[d[f]];for(f=l.length-1;-1!==f;--f)S[f]=r[l[f]];var V=M(S,w(_,w(h.I,v))),P=numeric._solveLP(V,j,A,i,a),q=P.solution;if(q!=q)return P;var F=w(h.I,M(o,w(v,q))),L=Array(r.length);for(f=d.length-1;-1!==f;--f)L[d[f]]=F[f];for(f=l.length-1;-1!==f;--f)L[l[f]]=q[f];return{solution:L,message:P.message,iterations:P.iterations}},numeric.MPStoLP=function(r){r instanceof String&&r.split("\n");var n,e,t,o,i=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],f=r.length,u=0,s={},c=[],h=0,x={},d=0,l=[],p=[],y=[];function g(n){throw Error("MPStoLP: "+n+"\nLine "+e+": "+r[e]+"\nCurrent state: "+a[i]+"\n")}for(e=0;e<f;++e){var v=(o=r[e]).match(/\S*/g),b=[];for(t=0;t<v.length;++t)""!==v[t]&&b.push(v[t]);if(0!==b.length){for(t=0;t<a.length&&o.substr(0,a[t].length)!==a[t];++t);if(t<a.length){if(i=t,1===t&&(n=b[1]),6===t)return{name:n,c:l,A:numeric.transpose(p),b:y,rows:s,vars:x};continue}switch(i){case 0:case 1:g("Unexpected line");case 2:switch(b[0]){case"N":0===u?u=b[1]:g("Two or more N rows");break;case"L":s[b[1]]=h,c[h]=1,y[h]=0,++h;break;case"G":s[b[1]]=h,c[h]=-1,y[h]=0,++h;break;case"E":s[b[1]]=h,c[h]=0,y[h]=0,++h;break;default:g("Parse error "+numeric.prettyPrint(b))}break;case 3:!x.hasOwnProperty(b[0])&&(x[b[0]]=d,l[d]=0,p[d]=numeric.rep([h],0),++d);var m=x[b[0]];for(t=1;t<b.length;t+=2){if(b[t]===u){l[m]=parseFloat(b[t+1]);continue}var w=s[b[t]];p[m][w]=(c[w]<0?-1:1)*parseFloat(b[t+1])}break;case 4:for(t=1;t<b.length;t+=2)y[s[b[t]]]=(c[s[b[t]]]<0?-1:1)*parseFloat(b[t+1]);break;case 5:break;case 6:g("Internal error")}}}g("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,n,e,t,o,i,a){function f(r){var n,t,o=this,i=r.length,a=0,f=o.i=o.j=o.m=0;for(o.S=[],o.c=[],i||(r=[i++]);a<e;)o.S[a]=a++;for(a=0;a<e;a++)f=c(f+(n=o.S[a])+r[a%i]),t=o.S[f],o.S[a]=t,o.S[f]=n;o.g=function(r){var n=o.S,t=c(o.i+1),i=n[t],a=c(o.j+i),f=n[a];n[t]=f,n[a]=i;for(var u=n[c(i+f)];--r;)i=n[t=c(t+1)],f=n[a=c(a+i)],n[t]=f,n[a]=i,u=u*e+n[c(i+f)];return o.i=t,o.j=a,u},o.g(e)}function u(r,n,e,t,o){if(e=[],o=typeof r,n&&"object"==o){for(t in r)if(5>t.indexOf("S"))try{e.push(u(r[t],n-1))}catch(r){}}return e.length?e:r+("string"!=o?"\0":"")}function s(r,n,e,t){for(r+="",e=0,t=0;t<r.length;t++)n[c(t)]=c((e^=19*n[c(t)])+r.charCodeAt(t));for(t in r="",n)r+=String.fromCharCode(n[t]);return r}function c(r){return r&e-1}n.seedrandom=function(c,h){var x,d=[];return c=s(u(h?[c,r]:arguments.length?c:[new Date().getTime(),r,window],3),d),s((x=new f(d)).S,r),n.random=function(){for(var r=x.g(t),n=a,f=0;r<o;)r=(r+f)*e,n*=e,f=x.g(1);for(;r>=i;)r/=2,n/=2,f>>>=1;return(r+f)/n},c},a=n.pow(e,t),i=2*(o=n.pow(2,o)),s(n.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function n(r){if("object"!=typeof r)return r;var e,t=[],o=r.length;for(e=0;e<o;e++)t[e+1]=n(r[e]);return t}function e(r){if("object"!=typeof r)return r;var n,t=[],o=r.length;for(n=1;n<o;n++)t[n-1]=e(r[n]);return t}function t(r,n,e){var t,o,i,a,f;for(i=1;i<=e;i+=1){for(t=1,r[i][i]=1/r[i][i],f=-r[i][i];t<i;t+=1)r[t][i]=f*r[t][i];if(e<(a=i+1))break;for(o=a;o<=e;o+=1)for(t=1,f=r[i][o],r[i][o]=0;t<=i;t+=1)r[t][o]=r[t][o]+f*r[t][i]}}function o(r,n,e,t){var o,i,a,f;for(i=1;i<=e;i+=1){for(o=1,f=0;o<i;o+=1)f+=r[o][i]*t[o];t[i]=(t[i]-f)/r[i][i]}for(a=1;a<=e;a+=1)for(o=1,t[i=e+1-a]=t[i]/r[i][i],f=-t[i];o<i;o+=1)t[o]=t[o]+f*r[o][i]}function i(r,n,e,t){var o,i,a,f,u,s;for(i=1;i<=e;i+=1){if(t[1]=i,s=0,(a=i-1)<1){if((s=r[i][i]-s)<=0)break;r[i][i]=Math.sqrt(s)}else{for(f=1;f<=a;f+=1){for(o=1,u=r[f][i];o<f;o+=1)u-=r[o][i]*r[o][f];u/=r[f][f],r[f][i]=u,s+=u*u}if((s=r[i][i]-s)<=0)break;r[i][i]=Math.sqrt(s)}t[1]=0}}function a(r,n,e,a,f,u,s,c,h,x,d,l,p,y,g,v){var b,m,w,M,k,j,A,_,S,V,P,q,F,L,N,O,U,D,B,X,R,E,Y,I,Q,Z,C;F=Math.min(a,x),w=2*a+F*(F+5)/2+2*x+1,I=1e-60;do I+=I,Q=1+.1*I,Z=1+.2*I;while(Q<=1||Z<=1)for(b=1;b<=a;b+=1)g[b]=n[b];for(b=a+1;b<=w;b+=1)g[b]=0;for(b=1;b<=x;b+=1)l[b]=0;if(k=[],0===v[1]){if(i(r,e,a,k),0!==k[1]){v[1]=2;return}o(r,e,a,n),t(r,e,a)}else{for(m=1;m<=a;m+=1)for(b=1,f[m]=0;b<=m;b+=1)f[m]=f[m]+r[b][m]*n[b];for(m=1;m<=a;m+=1)for(n[m]=0,b=m;b<=a;b+=1)n[m]=n[m]+r[m][b]*f[b]}for(m=1,u[1]=0;m<=a;m+=1)for(f[m]=n[m],u[1]=u[1]+g[m]*f[m],g[m]=0,b=m+1;b<=a;b+=1)r[b][m]=0;for(b=1,u[1]=-u[1]/2,v[1]=0,L=(V=(S=(P=(_=(A=a)+a)+F)+F+1)+F*(F+1)/2)+x;b<=x;b+=1){for(m=1,O=0;m<=a;m+=1)O+=s[m][b]*s[m][b];g[L+b]=Math.sqrt(O)}function H(){for(b=1,y[1]=y[1]+1,w=V;b<=x;b+=1){for(w+=1,O=-c[b],m=1;m<=a;m+=1)O+=s[m][b]*f[m];if(Math.abs(O)<I&&(O=0),b>d)g[w]=O;else if(g[w]=-Math.abs(O),O>0){for(m=1;m<=a;m+=1)s[m][b]=-s[m][b];c[b]=-c[b]}}for(b=1;b<=p;b+=1)g[V+l[b]]=0;for(b=1,q=0,N=0;b<=x;b+=1)g[V+b]<N*g[L+b]&&(q=b,N=g[V+b]/g[L+b]);return 999*(0===q)}function z(){for(b=1;b<=a;b+=1){for(m=1,O=0;m<=a;m+=1)O+=r[m][b]*s[m][q];g[b]=O}for(b=1,M=A;b<=a;b+=1)g[M+b]=0;for(m=p+1;m<=a;m+=1)for(b=1;b<=a;b+=1)g[M+b]=g[M+b]+r[b][m]*g[m];for(E=!0,b=p;b>=1;b-=1){for(O=g[b],M=(w=S+b*(b+3)/2)-b,m=b+1;m<=p;m+=1)O-=g[w]*g[_+m],w+=m;if(O/=g[M],g[_+b]=O,l[b]<d||O<0)break;E=!1,j=b}if(!E)for(b=1,U=g[P+j]/g[_+j];b<=p&&!(l[b]<d)&&!(g[_+b]<0);b+=1)(N=g[P+b]/g[_+b])<U&&(U=N,j=b);for(O=0,b=A+1;b<=A+a;b+=1)O+=g[b]*g[b];if(Math.abs(O)<=I)if(E)return v[1]=1,999;else{for(b=1;b<=p;b+=1)g[P+b]=g[P+b]-U*g[_+b];return g[P+p+1]=g[P+p+1]+U,700}for(b=1,O=0;b<=a;b+=1)O+=g[A+b]*s[b][q];for(D=-g[V+q]/O,Y=!0,!E&&U<D&&(D=U,Y=!1),b=1;b<=a;b+=1)f[b]=f[b]+D*g[A+b],Math.abs(f[b])<I&&(f[b]=0);for(b=1,u[1]=u[1]+D*O*(D/2+g[P+p+1]);b<=p;b+=1)g[P+b]=g[P+b]-D*g[_+b];if(g[P+p+1]=g[P+p+1]+D,Y){for(b=1,l[p+=1]=q,w=S+(p-1)*p/2+1;b<=p-1;b+=1)g[w]=g[b],w+=1;if(p===a)g[w]=g[a];else{for(b=a;b>=p+1&&0!==g[b]&&(B=Math.max(Math.abs(g[b-1]),Math.abs(g[b])),X=Math.min(Math.abs(g[b-1]),Math.abs(g[b])),N=g[b-1]>=0?Math.abs(B*Math.sqrt(1+X*X/(B*B))):-Math.abs(B*Math.sqrt(1+X*X/(B*B))),B=g[b-1]/N,X=g[b]/N,1!==B);b-=1)if(0===B)for(m=1,g[b-1]=X*N;m<=a;m+=1)N=r[m][b-1],r[m][b-1]=r[m][b],r[m][b]=N;else for(m=1,g[b-1]=N,R=X/(1+B);m<=a;m+=1)N=B*r[m][b-1]+X*r[m][b],r[m][b]=R*(r[m][b-1]+N)-r[m][b],r[m][b-1]=N;g[w]=g[p]}}else{for(m=1,O=-c[q];m<=a;m+=1)O+=f[m]*s[m][q];if(q>d)g[V+q]=O;else if(g[V+q]=-Math.abs(O),O>0){for(m=1;m<=a;m+=1)s[m][q]=-s[m][q];c[q]=-c[q]}return 700}return 0}function G(){if(0===g[M=(w=S+j*(j+1)/2+1)+j]||(B=Math.max(Math.abs(g[M-1]),Math.abs(g[M])),X=Math.min(Math.abs(g[M-1]),Math.abs(g[M])),N=g[M-1]>=0?Math.abs(B*Math.sqrt(1+X*X/(B*B))):-Math.abs(B*Math.sqrt(1+X*X/(B*B))),B=g[M-1]/N,X=g[M]/N,1===B))return 798;if(0===B){for(b=j+1;b<=p;b+=1)N=g[M-1],g[M-1]=g[M],g[M]=N,M+=b;for(b=1;b<=a;b+=1)N=r[b][j],r[b][j]=r[b][j+1],r[b][j+1]=N}else{for(R=X/(1+B),b=j+1;b<=p;b+=1)N=B*g[M-1]+X*g[M],g[M]=R*(g[M-1]+N)-g[M],g[M-1]=N,M+=b;for(b=1;b<=a;b+=1)N=B*r[b][j]+X*r[b][j+1],r[b][j+1]=R*(r[b][j]+N)-r[b][j+1],r[b][j]=N}return 0}function $(){for(b=1,M=w-j;b<=j;b+=1)g[M]=g[w],w+=1,M+=1;return 797*(g[P+j]=g[P+j+1],l[j]=l[j+1],(j+=1)<p)}function W(){return g[P+p]=g[P+p+1],g[P+p+1]=0,l[p]=0,p-=1,y[2]=y[2]+1,0}for(p=0,y[1]=0,y[2]=0,C=0;;){if(999===(C=H()))return;for(;0!==(C=z());){if(999===C)return;if(700===C)if(j===p)W();else{for(;G(),797===(C=$()););W()}}}}r.solveQP=function(r,t,o,i,f,u){r=n(r),t=n(t),o=n(o);var s,c,h,x,d,l,p=[],y=[],g=[],v=[],b=[];if(f=f||0,u=u?n(u):[void 0,0],i=i?n(i):[],c=r.length-1,h=o[1].length-1,!i)for(s=1;s<=h;s+=1)i[s]=0;for(s=1;s<=h;s+=1)y[s]=0;for(s=1,x=0,d=Math.min(c,h);s<=c;s+=1)g[s]=0;for(s=1,p[1]=0;s<=2*c+d*(d+5)/2+2*h+1;s+=1)v[s]=0;for(s=1;s<=2;s+=1)b[s]=0;return a(r,t,c,c,g,p,o,i,c,h,f,y,x,b,v,u),l="",1===u[1]&&(l="constraints are inconsistent, no solution!"),2===u[1]&&(l="matrix D in quadratic function is not positive definite!"),{solution:e(g),value:e(p),unconstrained_solution:e(t),iterations:e(b),iact:e(y),message:l}}}(numeric),numeric.svd=function(r){var n,e=numeric.epsilon,t=1e-64/e,o=50,i=0,a=0,f=0,u=0,s=0,c=numeric.clone(r),h=c.length,x=c[0].length;if(h<x)throw"Need more rows than columns";var d=Array(x),l=Array(x);for(a=0;a<x;a++)d[a]=l[a]=0;var p=numeric.rep([x,x],0);function y(r,n){return(r=Math.abs(r))>(n=Math.abs(n))?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var g=0,v=0,b=0,m=0,w=0,M=0,k=0;for(a=0;a<x;a++){for(d[a]=v,k=0,s=a+1,f=a;f<h;f++)k+=c[f][a]*c[f][a];if(k<=t)v=0;else for(g=c[a][a],v=Math.sqrt(k),g>=0&&(v=-v),b=g*v-k,c[a][a]=g-v,f=s;f<x;f++){for(k=0,u=a;u<h;u++)k+=c[u][a]*c[u][f];for(g=k/b,u=a;u<h;u++)c[u][f]+=g*c[u][a]}for(l[a]=v,k=0,f=s;f<x;f++)k+=c[a][f]*c[a][f];if(k<=t)v=0;else{for(g=c[a][a+1],v=Math.sqrt(k),g>=0&&(v=-v),b=g*v-k,c[a][a+1]=g-v,f=s;f<x;f++)d[f]=c[a][f]/b;for(f=s;f<h;f++){for(k=0,u=s;u<x;u++)k+=c[f][u]*c[a][u];for(u=s;u<x;u++)c[f][u]+=k*d[u]}}(w=Math.abs(l[a])+Math.abs(d[a]))>m&&(m=w)}for(a=x-1;-1!=a;a+=-1){if(0!=v){for(b=v*c[a][a+1],f=s;f<x;f++)p[f][a]=c[a][f]/b;for(f=s;f<x;f++){for(k=0,u=s;u<x;u++)k+=c[a][u]*p[u][f];for(u=s;u<x;u++)p[u][f]+=k*p[u][a]}}for(f=s;f<x;f++)p[a][f]=0,p[f][a]=0;p[a][a]=1,v=d[a],s=a}for(a=x-1;-1!=a;a+=-1){for(s=a+1,v=l[a],f=s;f<x;f++)c[a][f]=0;if(0!=v){for(b=c[a][a]*v,f=s;f<x;f++){for(k=0,u=s;u<h;u++)k+=c[u][a]*c[u][f];for(g=k/b,u=a;u<h;u++)c[u][f]+=g*c[u][a]}for(f=a;f<h;f++)c[f][a]=c[f][a]/v}else for(f=a;f<h;f++)c[f][a]=0;c[a][a]+=1}for(e*=m,u=x-1;-1!=u;u+=-1)for(var j=0;j<o;j++){var A=!1;for(s=u;-1!=s;s+=-1){if(Math.abs(d[s])<=e){A=!0;break}if(Math.abs(l[s-1])<=e)break}if(!A){i=0,k=1;var _=s-1;for(a=s;a<u+1&&(g=k*d[a],d[a]=i*d[a],!(Math.abs(g)<=e));a++)for(f=0,b=y(g,v=l[a]),l[a]=b,i=v/b,k=-g/b;f<h;f++)w=c[f][_],M=c[f][a],c[f][_]=w*i+M*k,c[f][a]=-w*k+M*i}if(M=l[u],s==u){if(M<0)for(f=0,l[u]=-M;f<x;f++)p[f][u]=-p[f][u];break}if(j>=o-1)throw"Error: no convergence.";for(m=l[s],w=l[u-1],v=y(g=((w-M)*(w+M)+((v=d[u-1])-(b=d[u]))*(v+b))/(2*b*w),1),g=g<0?((m-M)*(m+M)+b*(w/(g-v)-b))/m:((m-M)*(m+M)+b*(w/(g+v)-b))/m,i=1,k=1,a=s+1;a<u+1;a++){for(v=d[a],w=l[a],b=k*v,v*=i,M=y(g,b),d[a-1]=M,g=m*(i=g/M)+v*(k=b/M),v=-m*k+v*i,b=w*k,w*=i,f=0;f<x;f++)m=p[f][a-1],M=p[f][a],p[f][a-1]=m*i+M*k,p[f][a]=-m*k+M*i;for(f=0,M=y(g,b),l[a-1]=M,g=(i=g/M)*v+(k=b/M)*w,m=-k*v+i*w;f<h;f++)w=c[f][a-1],M=c[f][a],c[f][a-1]=w*i+M*k,c[f][a]=-w*k+M*i}d[s]=0,d[u]=g,l[u]=m}for(a=0;a<l.length;a++)l[a]<e&&(l[a]=0);for(a=0;a<x;a++)for(f=a-1;f>=0;f--)if(l[f]<l[a]){for(u=0,i=l[f],l[f]=l[a],l[a]=i;u<c.length;u++)n=c[u][a],c[u][a]=c[u][f],c[u][f]=n;for(u=0;u<p.length;u++)n=p[u][a],p[u][a]=p[u][f],p[u][f]=n;a=f}return{U:c,S:l,V:p}}}}]);