"use strict";(self.webpackChunk_0_tick_io=self.webpackChunk_0_tick_io||[]).push([["5826"],{86761:function(t,e,i){i.d(e,{ZU:()=>m});var n=i(86826);let o=new n.tBo,a=new n.Pq0,s=new n.Pq0,r=new n.PTz,h={X:new n.Pq0(1,0,0),Y:new n.Pq0(0,1,0),Z:new n.Pq0(0,0,1)},l={type:"change"},p={type:"mouseDown"},c={type:"mouseUp",mode:null},d={type:"objectChange"};class m extends n.B69{constructor(t,e){super(),void 0===e&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),e=document),this.isTransformControls=!0,this.visible=!1,this.domElement=e,this.domElement.style.touchAction="none";let i=new A;this._gizmo=i,this.add(i);let o=new z;this._plane=o,this.add(o);let a=this;function s(t,e){let n=e;Object.defineProperty(a,t,{get:function(){return void 0!==n?n:e},set:function(e){n!==e&&(n=e,o[t]=e,i[t]=e,a.dispatchEvent({type:t+"-changed",value:e}),a.dispatchEvent(l))}}),a[t]=e,o[t]=e,i[t]=e}s("camera",t),s("object",void 0),s("enabled",!0),s("axis",null),s("mode","translate"),s("translationSnap",null),s("rotationSnap",null),s("scaleSnap",null),s("space","world"),s("size",1),s("dragging",!1),s("showX",!0),s("showY",!0),s("showZ",!0);let r=new n.Pq0,h=new n.Pq0,p=new n.PTz,c=new n.PTz,d=new n.Pq0,m=new n.PTz,_=new n.Pq0,v=new n.Pq0,M=new n.Pq0,f=new n.Pq0;s("worldPosition",r),s("worldPositionStart",h),s("worldQuaternion",p),s("worldQuaternionStart",c),s("cameraPosition",d),s("cameraQuaternion",m),s("pointStart",_),s("pointEnd",v),s("rotationAxis",M),s("rotationAngle",0),s("eye",f),this._offset=new n.Pq0,this._startNorm=new n.Pq0,this._endNorm=new n.Pq0,this._cameraScale=new n.Pq0,this._parentPosition=new n.Pq0,this._parentQuaternion=new n.PTz,this._parentQuaternionInv=new n.PTz,this._parentScale=new n.Pq0,this._worldScaleStart=new n.Pq0,this._worldQuaternionInv=new n.PTz,this._worldScale=new n.Pq0,this._positionStart=new n.Pq0,this._quaternionStart=new n.PTz,this._scaleStart=new n.Pq0,this._getPointer=w.bind(this),this._onPointerDown=y.bind(this),this._onPointerHover=u.bind(this),this._onPointerMove=P.bind(this),this._onPointerUp=b.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(t){if(void 0===this.object||!0===this.dragging)return;o.setFromCamera(t,this.camera);let e=_(this._gizmo.picker[this.mode],o);e?this.axis=e.object.name:this.axis=null}pointerDown(t){if(void 0!==this.object&&!0!==this.dragging&&0===t.button&&null!==this.axis){o.setFromCamera(t,this.camera);let e=_(this._plane,o,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,p.mode=this.mode,this.dispatchEvent(p)}}pointerMove(t){let e=this.axis,i=this.mode,n=this.object,p=this.space;if("scale"===i?p="local":("E"===e||"XYZE"===e||"XYZ"===e)&&(p="world"),void 0===n||null===e||!1===this.dragging||-1!==t.button)return;o.setFromCamera(t,this.camera);let c=_(this._plane,o,!0);if(c){if(this.pointEnd.copy(c.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===p&&"XYZ"!==e&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===e.indexOf("X")&&(this._offset.x=0),-1===e.indexOf("Y")&&(this._offset.y=0),-1===e.indexOf("Z")&&(this._offset.z=0),"local"===p&&"XYZ"!==e?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),n.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===p&&(n.position.applyQuaternion(r.copy(this._quaternionStart).invert()),-1!==e.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.position.applyQuaternion(this._quaternionStart)),"world"===p&&(n.parent&&n.position.add(a.setFromMatrixPosition(n.parent.matrixWorld)),-1!==e.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.parent&&n.position.sub(a.setFromMatrixPosition(n.parent.matrixWorld))));else if("scale"===i){if(-1!==e.search("XYZ")){let t=this.pointEnd.length()/this.pointStart.length();0>this.pointEnd.dot(this.pointStart)&&(t*=-1),s.set(t,t,t)}else a.copy(this.pointStart),s.copy(this.pointEnd),a.applyQuaternion(this._worldQuaternionInv),s.applyQuaternion(this._worldQuaternionInv),s.divide(a),-1===e.search("X")&&(s.x=1),-1===e.search("Y")&&(s.y=1),-1===e.search("Z")&&(s.z=1);n.scale.copy(this._scaleStart).multiply(s),this.scaleSnap&&(-1!==e.search("X")&&(n.scale.x=Math.round(n.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Y")&&(n.scale.y=Math.round(n.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Z")&&(n.scale.z=Math.round(n.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);let t=20/this.worldPosition.distanceTo(a.setFromMatrixPosition(this.camera.matrixWorld));"E"===e?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=0>this._endNorm.cross(this._startNorm).dot(this.eye)?1:-1):"XYZE"===e?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(a.copy(this.rotationAxis).cross(this.eye))*t):("X"===e||"Y"===e||"Z"===e)&&(this.rotationAxis.copy(h[e]),a.copy(h[e]),"local"===p&&a.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(a.cross(this.eye).normalize())*t),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===p&&"E"!==e&&"XYZE"!==e?(n.quaternion.copy(this._quaternionStart),n.quaternion.multiply(r.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),n.quaternion.copy(r.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),n.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(l),this.dispatchEvent(d)}}pointerUp(t){0===t.button&&(this.dragging&&null!==this.axis&&(c.mode=this.mode,this.dispatchEvent(c)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}attach(t){return this.object=t,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(l),this.dispatchEvent(d),this.pointStart.copy(this.pointEnd))}getRaycaster(){return o}getMode(){return this.mode}setMode(t){this.mode=t}setTranslationSnap(t){this.translationSnap=t}setRotationSnap(t){this.rotationSnap=t}setScaleSnap(t){this.scaleSnap=t}setSize(t){this.size=t}setSpace(t){this.space=t}}function w(t){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:t.button};{let e=this.domElement.getBoundingClientRect();return{x:(t.clientX-e.left)/e.width*2-1,y:-(t.clientY-e.top)/e.height*2+1,button:t.button}}}function u(t){if(this.enabled)switch(t.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(t))}}function y(t){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(t.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(t)),this.pointerDown(this._getPointer(t)))}function P(t){this.enabled&&this.pointerMove(this._getPointer(t))}function b(t){this.enabled&&(this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(t)))}function _(t,e,i){let n=e.intersectObject(t,!0);for(let t=0;t<n.length;t++)if(n[t].object.visible||i)return n[t];return!1}let v=new n.O9p,M=new n.Pq0(0,1,0),f=new n.Pq0(0,0,0),g=new n.kn4,x=new n.PTz,S=new n.PTz,F=new n.Pq0,E=new n.kn4,I=new n.Pq0(1,0,0),q=new n.Pq0(0,1,0),Y=new n.Pq0(0,0,1),X=new n.Pq0,Q=new n.Pq0,Z=new n.Pq0;class A extends n.B69{constructor(){let t;super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";let e=new n.V9B({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=new n.mrM({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),o=e.clone();o.opacity=.15;let a=i.clone();a.opacity=.5;let s=e.clone();s.color.setHex(0xff0000);let r=e.clone();r.color.setHex(65280);let h=e.clone();h.color.setHex(255);let l=e.clone();l.color.setHex(0xff0000),l.opacity=.5;let p=e.clone();p.color.setHex(65280),p.opacity=.5;let c=e.clone();c.color.setHex(255),c.opacity=.5;let d=e.clone();d.opacity=.25;let m=e.clone();m.color.setHex(0xffff00),m.opacity=.25,e.clone().color.setHex(0xffff00);let w=e.clone();w.color.setHex(7895160);let u=new n.Ho_(0,.04,.1,12);u.translate(0,.05,0);let y=new n.iNn(.08,.08,.08);y.translate(0,.04,0);let P=new n.LoY;P.setAttribute("position",new n.qtW([0,0,0,1,0,0],3));let b=new n.Ho_(.0075,.0075,.5,3);function _(t,e){let i=new n.O3Y(t,.0075,3,64,e*Math.PI*2);return i.rotateY(Math.PI/2),i.rotateX(Math.PI/2),i}b.translate(0,.25,0);let v={X:[[new n.eaF(u,s),[.5,0,0],[0,0,-Math.PI/2]],[new n.eaF(u,s),[-.5,0,0],[0,0,Math.PI/2]],[new n.eaF(b,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new n.eaF(u,r),[0,.5,0]],[new n.eaF(u,r),[0,-.5,0],[Math.PI,0,0]],[new n.eaF(b,r)]],Z:[[new n.eaF(u,h),[0,0,.5],[Math.PI/2,0,0]],[new n.eaF(u,h),[0,0,-.5],[-Math.PI/2,0,0]],[new n.eaF(b,h),null,[Math.PI/2,0,0]]],XYZ:[[new n.eaF(new n.Ufg(.1,0),d.clone()),[0,0,0]]],XY:[[new n.eaF(new n.iNn(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new n.eaF(new n.iNn(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new n.eaF(new n.iNn(.15,.15,.01),p.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},M={X:[[new n.eaF(new n.Ho_(.2,0,.6,4),o),[.3,0,0],[0,0,-Math.PI/2]],[new n.eaF(new n.Ho_(.2,0,.6,4),o),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,.3,0]],[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,-.3,0],[0,0,Math.PI]]],Z:[[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,0,.3],[Math.PI/2,0,0]],[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new n.eaF(new n.Ufg(.2,0),o)]],XY:[[new n.eaF(new n.iNn(.2,.2,.01),o),[.15,.15,0]]],YZ:[[new n.eaF(new n.iNn(.2,.2,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new n.eaF(new n.iNn(.2,.2,.01),o),[.15,0,.15],[-Math.PI/2,0,0]]]},f={START:[[new n.eaF(new n.Ufg(.01,2),a),null,null,null,"helper"]],END:[[new n.eaF(new n.Ufg(.01,2),a),null,null,null,"helper"]],DELTA:[[new n.N1A(((t=new n.LoY).setAttribute("position",new n.qtW([0,0,0,1,1,1],3)),t),a),null,null,null,"helper"]],X:[[new n.N1A(P,a.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new n.N1A(P,a.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new n.N1A(P,a.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},g={XYZE:[[new n.eaF(_(.5,1),w),null,[0,Math.PI/2,0]]],X:[[new n.eaF(_(.5,.5),s)]],Y:[[new n.eaF(_(.5,.5),r),null,[0,0,-Math.PI/2]]],Z:[[new n.eaF(_(.5,.5),h),null,[0,Math.PI/2,0]]],E:[[new n.eaF(_(.75,1),m),null,[0,Math.PI/2,0]]]},x={AXIS:[[new n.N1A(P,a.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},S={XYZE:[[new n.eaF(new n.Gu$(.25,10,8),o)]],X:[[new n.eaF(new n.O3Y(.5,.1,4,24),o),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new n.eaF(new n.O3Y(.5,.1,4,24),o),[0,0,0],[Math.PI/2,0,0]]],Z:[[new n.eaF(new n.O3Y(.5,.1,4,24),o),[0,0,0],[0,0,-Math.PI/2]]],E:[[new n.eaF(new n.O3Y(.75,.1,2,24),o)]]},F={X:[[new n.eaF(y,s),[.5,0,0],[0,0,-Math.PI/2]],[new n.eaF(b,s),[0,0,0],[0,0,-Math.PI/2]],[new n.eaF(y,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new n.eaF(y,r),[0,.5,0]],[new n.eaF(b,r)],[new n.eaF(y,r),[0,-.5,0],[0,0,Math.PI]]],Z:[[new n.eaF(y,h),[0,0,.5],[Math.PI/2,0,0]],[new n.eaF(b,h),[0,0,0],[Math.PI/2,0,0]],[new n.eaF(y,h),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new n.eaF(new n.iNn(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new n.eaF(new n.iNn(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new n.eaF(new n.iNn(.15,.15,.01),p),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new n.eaF(new n.iNn(.1,.1,.1),d.clone())]]},E={X:[[new n.eaF(new n.Ho_(.2,0,.6,4),o),[.3,0,0],[0,0,-Math.PI/2]],[new n.eaF(new n.Ho_(.2,0,.6,4),o),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,.3,0]],[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,-.3,0],[0,0,Math.PI]]],Z:[[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,0,.3],[Math.PI/2,0,0]],[new n.eaF(new n.Ho_(.2,0,.6,4),o),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new n.eaF(new n.iNn(.2,.2,.01),o),[.15,.15,0]]],YZ:[[new n.eaF(new n.iNn(.2,.2,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new n.eaF(new n.iNn(.2,.2,.01),o),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new n.eaF(new n.iNn(.2,.2,.2),o),[0,0,0]]]},I={X:[[new n.N1A(P,a.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new n.N1A(P,a.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new n.N1A(P,a.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function q(t){let e=new n.B69;for(let i in t)for(let n=t[i].length;n--;){let o=t[i][n][0].clone(),a=t[i][n][1],s=t[i][n][2],r=t[i][n][3],h=t[i][n][4];o.name=i,o.tag=h,a&&o.position.set(a[0],a[1],a[2]),s&&o.rotation.set(s[0],s[1],s[2]),r&&o.scale.set(r[0],r[1],r[2]),o.updateMatrix();let l=o.geometry.clone();l.applyMatrix4(o.matrix),o.geometry=l,o.renderOrder=1/0,o.position.set(0,0,0),o.rotation.set(0,0,0),o.scale.set(1,1,1),e.add(o)}return e}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=q(v)),this.add(this.gizmo.rotate=q(g)),this.add(this.gizmo.scale=q(F)),this.add(this.picker.translate=q(M)),this.add(this.picker.rotate=q(S)),this.add(this.picker.scale=q(E)),this.add(this.helper.translate=q(f)),this.add(this.helper.rotate=q(x)),this.add(this.helper.scale=q(I)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(t){let e="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:S;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let i=[];i=(i=(i=i.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(let t=0;t<i.length;t++){let n,o=i[t];if(o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),n=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(n*this.size/4),"helper"===o.tag){o.visible=!1,"AXIS"===o.name?(o.visible=!!this.axis,"X"===this.axis&&(r.setFromEuler(v.set(0,0,0)),o.quaternion.copy(e).multiply(r),Math.abs(M.copy(I).applyQuaternion(e).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(r.setFromEuler(v.set(0,0,Math.PI/2)),o.quaternion.copy(e).multiply(r),Math.abs(M.copy(q).applyQuaternion(e).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(r.setFromEuler(v.set(0,Math.PI/2,0)),o.quaternion.copy(e).multiply(r),Math.abs(M.copy(Y).applyQuaternion(e).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(r.setFromEuler(v.set(0,Math.PI/2,0)),M.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(g.lookAt(f,M,q)),o.quaternion.multiply(r),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),a.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),a.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(a),o.visible=this.dragging):(o.quaternion.copy(e),this.dragging?o.position.copy(this.worldPositionStart):o.position.copy(this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name)));continue}o.quaternion.copy(e),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(M.copy(I).applyQuaternion(e).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(M.copy(q).applyQuaternion(e).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(M.copy(Y).applyQuaternion(e).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&.2>Math.abs(M.copy(Y).applyQuaternion(e).dot(this.eye))&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&.2>Math.abs(M.copy(I).applyQuaternion(e).dot(this.eye))&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&.2>Math.abs(M.copy(q).applyQuaternion(e).dot(this.eye))&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(x.copy(e),M.copy(this.eye).applyQuaternion(r.copy(e).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(g.lookAt(this.eye,f,q)),"X"===o.name&&(r.setFromAxisAngle(I,Math.atan2(-M.y,M.z)),r.multiplyQuaternions(x,r),o.quaternion.copy(r)),"Y"===o.name&&(r.setFromAxisAngle(q,Math.atan2(M.x,M.z)),r.multiplyQuaternions(x,r),o.quaternion.copy(r)),"Z"===o.name&&(r.setFromAxisAngle(Y,Math.atan2(M.y,M.x)),r.multiplyQuaternions(x,r),o.quaternion.copy(r))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis?(o.material.color.setHex(0xffff00),o.material.opacity=1):this.axis.split("").some(function(t){return o.name===t})&&(o.material.color.setHex(0xffff00),o.material.opacity=1))}super.updateMatrixWorld(t)}}class z extends n.eaF{constructor(){super(new n.bdM(1e5,1e5,2,2),new n.V9B({visible:!1,wireframe:!0,side:n.$EB,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(t){let e=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(e="local"),X.copy(I).applyQuaternion("local"===e?this.worldQuaternion:S),Q.copy(q).applyQuaternion("local"===e?this.worldQuaternion:S),Z.copy(Y).applyQuaternion("local"===e?this.worldQuaternion:S),M.copy(Q),this.mode){case"translate":case"scale":switch(this.axis){case"X":M.copy(this.eye).cross(X),F.copy(X).cross(M);break;case"Y":M.copy(this.eye).cross(Q),F.copy(Q).cross(M);break;case"Z":M.copy(this.eye).cross(Z),F.copy(Z).cross(M);break;case"XY":F.copy(Z);break;case"YZ":F.copy(X);break;case"XZ":M.copy(Z),F.copy(Q);break;case"XYZ":case"E":F.set(0,0,0)}break;default:F.set(0,0,0)}0===F.length()?this.quaternion.copy(this.cameraQuaternion):(E.lookAt(a.set(0,0,0),F,M),this.quaternion.setFromRotationMatrix(E)),super.updateMatrixWorld(t)}}}}]);