---
sidebar_position: 5
---
import { Mafs, Coordinates, Plot, Line, Circle, Theme, useMovablePoint, useStopwatch, vec, Vector, LaTeX, Polygon, Transform } from "mafs";

import { lineLabel } from "@site/src/utilities/lines";
import { color } from "@site/src/utilities/colors"
import { useState } from "react";
import range from "lodash/range";
import { gamma } from "mathjs";
import TOCInline from '@theme/TOCInline';

# Integration

Integration is the process of finding the integral of a function. It is the reverse process of differentiation, and is used to find the area under a curve, the volume of a solid, and many other quantities.

## Table of Contents

<TOCInline toc={toc} />

## Area Under a Curve through Accumulation of Infinitesimal Areas

Imagine a curve like this one:

<Mafs
    viewBox={{
        x: [-1, 6],
        y: [-1, 6]
    }}
>
    <Coordinates.Cartesian/>
    <Plot.OfX
        y={(x) => x * (5 - x)}
    />
</Mafs>

This is a curve defined by the function $v(x) = x(5 - x)$.
Let this be the velocity of a vehicle at time $t$ (imagine it as a reading on the speedometer).

From differentiation we know that the derivative of the displacement function $s(t)$ is the velocity function $v(t)$.
In other words, $\dv{s}{t}(t) = v(t)$.

If we want to find the displacement of the vehicle at time $t$, we need to find a function $s(t)$ whose derivative is $v(t)$.
This is known as the antiderivative of $v(t)$.

A visual representation of this is the area under the curve of $v(t)$ from $0$ to $t$.
Since you can't just find the area (for now), you can approximate it by finding the area of rectangles.

A visualization is shown below:

{(() => {
    const ub = useMovablePoint([3, 0], {
        constrain: ([x, y]) => [Math.min(Math.max(x, 0), 5), 0]
    });
    const [n, setN] = useState(10);
    return (
        <div className="card">
            <div className="card__header">
                <h2>Area Under a Curve</h2>
            </div>
            <div className="card__body">
                <Mafs
                    viewBox={{
                        x: [-1, 6],
                        y: [-1, 6]
                    }}
                >
                    <Coordinates.Cartesian />
                    {ub.element}
                    <RiemannApproximation
                        f={(x) => x * (5 - x)}
                        lb={0}
                        ub={ub.point[0]}
                        n={n}
                    />
                </Mafs>
                {/* Slider */}
                <ControlPanel>
                    <SliderInput latex label="n" value={n} min={1} max={20} onChange={setN} />
                </ControlPanel>
            </div>
        </div>
    )
})()}

For each rectangle at time $t_i$, the width is $\Delta t$ and the height is $v(t_i)$. Hence, the area of the rectangle is $v(t_i) \Delta t$.
The total area is the sum of the areas of all the rectangles:

$$
\begin{equation}
\text{Area} = \sum_{i} v(t_i) \Delta t
\end{equation}
$$

Because $\Delta t \to 0$, the sum becomes a "continuous sum". This is what we call an integral:

$$
\begin{equation}
\text{Area} = \int_{0}^{T_1} v(t) \dd{t}
\end{equation}
$$

### Accumulation of Areas and the Fundamental Theorem of Calculus

Now, let's consider how to actually compute the area. Recall that the area of the velocity curve is equivalent to the displacement of the vehicle.

In other words:

$$
\begin{equation}
s(T_1) = \int_{0}^{T_1} v(t) \dd{t}
\end{equation}
$$

Additionally, recall that to find the slope of a function, we took an infinitesimal change in $x$ and found the change in $y$.
We can apply the same principle here: if we increment $t$, then we can calculate the change in the area.

{(() => {
    const T = 3;
    const dT = 0.3;
    const f = (x) => x * (5 - x);
    const boundedFunction = (x) => x > 3 ? 0 : f(x);
    return (
        <Mafs
            viewBox={{
                x: [-1, 6],
                y: [-1, 6]
            }}
        >
            <Coordinates.Cartesian/>
            <Plot.OfX
                y={f}
            />
            <Plot.Inequality
                y={{
                    "<=": boundedFunction,
                    ">=": (x) => 0
                }}
            />
            <Polygon
                points={[
                    [T, 0],
                    [T, f(T)],
                    [T + dT, f(T)],
                    [T + dT, 0]
                ]}
                color={color("green")}
                fillOpacity={0.5}
            />
        </Mafs>
    )
})()}

At time $T_1$, if we increment $t$ by $\Delta t$, then the area will be added by another rectangle, as shown above in green.
The width of the rectangle is $\Delta t$ and the height is $v(T_1)$.
Therefore:

$$
\begin{equation}
\Delta s = v(T_1) \Delta t
\end{equation}
$$

And if we rearrange:

$$
\begin{equation}
\frac{\Delta s}{\Delta t} = v(t)
\end{equation}
$$

And as $\Delta t \to 0$:

$$
\begin{equation}
\dv{s}{t} = v(t)
\end{equation}
$$

We have derived something known as the fundamental theorem of calculus:

<Boxed>
$$
\begin{align}
    \dv{s}{t} &= v(t) \\
    s(T_1) &= \int_{0}^{T_1} v(t) \dd{t}
\end{align}
$$
</Boxed>

## The Antiderivative

As shown above, the fundamental theorem of calculus states that the antiderivative of a function is the area under the curve of the function.

To find the antiderivative of a function, we take what we know about differentiation and work backwards.

For example, consider the antiderivative of $x^n$.
Recall that the derivative of $x^a$ is $ax^{a - 1}$.
To get rid of the coefficient, simply divide by $a$; so the derivative of $x^a/a$ is $x^{a - 1}$.

If we posit $x^n = x^{a - 1}$, then $a - 1 = n$ and $a = n + 1$.

Therefore, the antiderivative of $x^n$ is $x^{n + 1}/(n + 1)$.

### Antiderivative Notation

The antiderivative of a function $f(x)$ is denoted as $\int f(x) \dd{x}$. When we took the antiderivative of $x^n$, we can write it as:

$$
\begin{equation}
\int x^n \dd{x} = \frac{x^{n + 1}}{n + 1}
\end{equation}
$$

**HOWEVER**, we are missing something. Let's say $n = 4$. Then the antiderivative of $x^4$ is $x^5/5$.

Recall that the antiderivative is the function whose derivative is the original function.

Since the derivative of $x^5/5$ is $5x^4$, it is the antiderivative of $x^4$.
However, the derivative of $x^5/5 + 1$ is $5x^4$ as well, as well as the derivative of $x^5/5 + 2$, and so on, since the derivative of a constant is $0$.

Visually, this looks like moving the antiderivative up and down the $y$-axis:

{(() => {
    const f = (x) => x ** 4;
    const F = (x) => x ** 5 / 5;
    const offset = useMovablePoint([0, 0], {
        constrain: ([x, y]) => [0, y]
    });
    return (
        <Mafs
            viewBox={{
                x: [-1, 6],
                y: [-1, 6]
            }}
        >
            <Coordinates.Cartesian/>
            <Plot.OfX
                y={(x) => F(x) + offset.point[1]}
            />
            {offset.element}
        </Mafs>
    )
})()}

We can denote this constant as $C$. Therefore, we can revise our antiderivative as:

$$
\begin{equation}
\int x^n \dd{x} = \frac{x^{n + 1}}{n + 1} + C
\end{equation}
$$

We have now found the antiderivative of $x^n$, known as the power rule of integration.

## Definite Integrals

Now let's connect the antiderivative to the area under the curve. Using what we know so far:

$$
\begin{equation}
\int_{0}^{T_1} v(t) \dd{t} = s(T_1) + C \label{eq:definite_integrals-antiderivative}
\end{equation}
$$

However, what do we set $C$ as? It can't be any constant, since the area under the curve is a specific value.
To solve this conundrum, we introduce the concept of a definite integral. Let's say we want to find the area under the curve of $v(t)$ from $0$ to $0$.
This is obviously $0$, so, plugging this into Equation $\eqref{eq:definite_integrals-antiderivative}$:

$$
\begin{equation}
\int_{0}^{0} v(t) \dd{t} = 0 = s(0) + C
\end{equation}
$$

Therefore, $C = -s(0)$. This is the basis of the definite integral:

$$
\begin{equation}
\int_{0}^{T_1} v(t) \dd{t} = s(T_1) - s(0)
\end{equation}
$$

We can also replace $0$ with any arbitrary constant. For example, if we want to find the area under the curve of $v(t)$ from $T_0$ to $T_1$:

$$
\begin{equation}
\int_{T_0}^{T_1} v(t) \dd{t} = s(T_1) - s(T_0)
\end{equation}
$$

Notice that the area under the curve is derived solely from the endpoints $T_0$ and $T_1$, and nothing in between.

## Proof of the Fundamental Theorem of Calculus

The fundamental theorem of calculus states two things:

1. $\displaystyle \dv{x} \int_{0}^{x} f(t) \dd{t} = f(x)$
2. $\displaystyle \int_{a}^{b} f(x) \dd{x} = F(b) - F(a)$

While we have shown it intuitively, we can also prove it rigorously.
Both are equally important, as the intuitive visualization helps people understand the concept and helps the concept stick in their minds, while the rigorous proof ensures the validity and correctness of the concept.

### Proof of the First Part

First, let $f: \mathbb{R} \to \mathbb{R}$ be a function continuous on $[a, b]$.

Let $F(x) = \int_{a}^{x} f(t) \dd{t}$ be the accumulation function of $f(x)$ where $a \leq x \leq b$.

export function FTOCProof1({ showDx = false, showMVT = false }) {
    const f = (x) => Math.sin(x / 2) + 4;
    const F = (x) => -2 * Math.cos(x / 2) + 4 * x;
    const a = 2, b = 8;
    const x = useMovablePoint([a + 2, 0], {
        constrain: ([x, y]) => [Math.min(Math.max(x, a), b), 0],
        color: color("green")
    });
    const dx = 1.5;
    const x2 = x.point[0] + dx;
    const mvtHeight = (F(x2) - F(x.point[0])) / dx;
    return (
        <Mafs
            viewBox={{
                x: [-1, 11],
                y: [-1, 6]
            }}
        >
            <Coordinates.Cartesian
                xAxis={{
                    lines: false,
                    labels: () => ""
                }}
                yAxis={{
                    lines: false,
                    labels: () => ""
                }}
            />
            <Plot.OfX
                y={f}
            />
            {/* a */}
            <Line.Segment
                point1={[a, 0]}
                point2={[a, f(a)]}
            />
            <LaTeX
                at={[a, -0.5]}
                tex="a"
            />
            {/* b */}
            <Line.Segment
                point1={[b, 0]}
                point2={[b, f(b)]}
            />
            <LaTeX
                at={[b, -0.5]}
                tex="b"
            />
            {/* x */}
            {x.element}
            <Line.Segment
                point1={x.point}
                point2={[x.point[0], f(x.point[0])]}
                color={color("green")}
            />
            <LaTeX
                at={[x.point[0], -0.5]}
                tex="x"
            />
            {/* dx */}
            {showDx && (
                <>
                    <Line.Segment
                        point1={[x2, 0]}
                        point2={[x2, f(x2)]}
                        color={color("green")}
                    />
                    <LaTeX
                        at={[x2, -0.5]}
                        tex="x + \Delta x"
                    />
                    <Plot.Inequality
                        y={{
                            "<=": (value) => (value >= x.point[0] && value <= x2) ? f(value) : 0,
                            ">=": (x) => 0
                        }}
                        fill={color("green")}
                        fillOpacity={0.5}
                        xDomain={[x.point[0], x2]}
                    />
                    {showMVT && (
                        <>
                            <Polygon
                                points={[
                                    [x.point[0], 0],
                                    [x.point[0], mvtHeight],
                                    [x2, mvtHeight],
                                    [x2, 0]
                                ]}
                                color={color("green")}
                                fillOpacity={0.5}
                            />
                        </>
                    )}
                </>
            )}
        </Mafs>
    )
}

<FTOCProof1 />

Using the definition of the derivative, the derivative of $F(x)$ is:

$$
\begin{equation}
\begin{split}
\dv{x} F(x) &= \lim_{\Delta x \to 0} \frac{F(x + \Delta x) - F(x)}{h} \\
&= \lim_{\Delta x \to 0} \frac{\int_{a}^{x + \Delta x} f(t) \dd{t} - \int_{a}^{x} f(t) \dd{t}}{\Delta x}
\end{split}
\end{equation}
$$

<FTOCProof1 showDx={true} />

As shown in the graph, the numerator can be represented as the area under the curve of $f(t)$ from $x$ to $x + \Delta x$. Therefore:

$$
\begin{equation}
\begin{split}
\dv{x} F(x) &= \lim_{\Delta x \to 0} \frac{1}{\Delta x} \int_{x}^{x + \Delta x} f(t) \dd{t} \\
\end{split}
\end{equation}
$$

The Mean-Value Theorem states:

$$
\begin{equation}
\exists c \in [x, x + \Delta x] \text{ such that } f(c)\Delta x = \frac{1}{\Delta x} \int_{x}^{x + \Delta x} f(t) \dd{t}
\end{equation}
$$

Which is a fancy way of saying that there is some rectangle whose area is exactly the area under the segment of the curve.
It's called the Mean-Value Theorem because the right-hand side is the average value of the function over the interval $[x, x + \Delta x]$.

<FTOCProof1 showDx={true} showMVT={true} />

Therefore:

$$
\begin{equation}
\dv{x} F(x) = \lim_{\Delta x \to 0} f(c)
\end{equation}
$$

Since $x \leq c \leq x + \Delta x$, as $\Delta x \to 0 \Rightarrow c \to x$.

Therefore:

$$
\begin{equation}
\dv{x} F(x) = f(x)
\end{equation}
$$

## Riemann Sums

When we approximated the area under the curve of $v(t)$, we used rectangles. Now we will go into more detail about this process.

What we did is known as a Riemann sum. Let's once again consider the velocity function $v(t)$:

{(() => {
    const n = 5;
    const f = (x) => x * (5 - x);
    const lb = 0, ub = 3, dt = (ub - lb) / n;
    /** @type {"left" | "right" | "middle" | "trapezoidal"} */
    const [type, setType] = useState("left");
    return (
        <>
            <Mafs
                viewBox={{
                    x: [-1, 6],
                    y: [-1, 6]
                }}
            >
                <Coordinates.Cartesian />
                <RiemannApproximation
                    f={(x) => x * (5 - x)}
                    lb={lb}
                    ub={ub}
                    n={n}
                    type={type}
                />
                {range(lb, ub, dt).map((t, i) => (
                    <span key={i}>
                        <Vector
                            tail={[t, 0]}
                            tip={[t + dt, 0]}
                            color={color("green")}
                        />
                        <LaTeX
                            at={[t + dt, -0.5]}
                            tex={`t_${i + 1}`}
                        />
                    </span>
                ))}
            </Mafs>
            <select
                value={type}
                onChange={(e) => setType(e.target.value)}
            >
                <option value="left">Left</option>
                <option value="right">Right</option>
                <option value="middle">Middle</option>
                <option value="trapezoidal">Trapezoidal</option>
            </select>
        </>
    )
})()}

Riemann sums can be categorized into different types:

- The **left Riemann sum** uses the left endpoint of each interval as the height of the rectangle.
- The **right Riemann sum** uses the right endpoint of each interval as the height of the rectangle.
- The **midpoint Riemann sum** uses the midpoint of each interval as the height of the rectangle.
- The **trapezoidal Riemann sum** uses a trapezoid instead of a rectangle.

The general procedure for a Riemann sum is as follows:

1. **Identify $\Delta t$**. As we know, the area of each rectangle is $v(t_i) \Delta t$. In the interval $[T_0, T_1]$, since there are $n$ rectangles, the width of each rectangle is $\Delta t = \frac{T_1 - T_0}{n}$.
2. **Identify $t_i$**. As shown in the graph, $t_i$ can be represented as $T_0$ plus all the arrows pointing to the right. Therefore, $t_i = T_0 + i \Delta t$.
3. **Using the above values, identify the area of each $i$th rectangle**. The area of each rectangle can be represented as $v(T_0 + i \Delta t) \Delta t$.
4. **Identify $i$ and sum all the areas**. The total area is the sum of all the areas of the rectangles:

    $$
    \begin{equation}
    \text{Area} = \sum_{i} v(T_0 + i \Delta t) \Delta t = \Delta t \sum_{i} v(T_0 + i \Delta t) \label{eq:riemann_sums-total-area}
    \end{equation}
    $$

    Identifying the bounds of the sum depends on the type of Riemann sum used:
    - For a left Riemann sum, start at $i = 0$ and end at $i = n - 1$.
    - For a right Riemann sum, start at $i = 1$ and end at $i = n$.
    - For a midpoint Riemann sum, start at $i = 0.5$ and end at $i = n - 0.5$.

    For example, the left Riemann sum can be represented as:

    $$
    \begin{equation}
    \text{Area} = \sum_{i = 0}^{n - 1} v(T_0 + i \Delta t) \Delta t = \Delta t \sum_{i = 0}^{n - 1} v(T_0 + i \Delta t)
    \end{equation}
    $$

### Trapezoidal Rule

The trapezoidal Riemann sum is a more accurate approximation of the area under the curve than the rectangular Riemann sums.

Recall that the area of a trapezoid is $\frac{1}{2} h (b_1 + b_2)$, where $h$ is the height and $b_1$ and $b_2$ are the bases.

In this case, if we split the area into trapezoids, $h$ is $\Delta t$ and $b_1$ and $b_2$ are $v(t_i)$ and $v(t_{i + 1})$ respectively.
Therefore, the area of each trapezoid is $\frac{1}{2} \Delta t (v(t_i) + v(t_{i + 1}))$.

The total area is the sum of all the areas of the trapezoids:

$$
\begin{equation}
\text{Area} = \sum_{i = 0}^{n - 1} \frac{1}{2} \Delta t (v(T_0 + i \Delta t) + v(T_0 + (i + 1) \Delta t)) = \frac{\Delta t}{2} \sum_{i = 0}^{n - 1} v(T_0 + i \Delta t) + v(T_0 + (i + 1) \Delta t)
\end{equation}
$$

If we let $n \to \infty$, then we don't need to use the trapezoidal rule, as the Riemann sum will converge to the actual area under the curve no matter what is used.

### Integral as a Limit of Riemann Sums

If we let $n \to \infty$, then the Riemann sum will converge to the actual area under the curve.

Therefore, we can generalize the area under the curve as the limit of $\eqref{eq:riemann_sums-total-area}$ as $n \to \infty$:

$$
\int_{T_0}^{T_1} v(t) \dd{t} = \lim_{n \to \infty} \sum_{i = 0}^{n - 1} v(T_0 + i \Delta t) \Delta t
$$

:::info Proof using Epsilon-Delta

Firstly, the above can be formalized into a theorem:

> Let $f: \mathbb{R} \to \mathbb{R}$ be a function continuous on $[a, b]$. The limit of the Riemann sum of $f$ over $[a, b]$ as the mesh of the partition approaches $0$ is equivalent to the integral of $f$ over $[a, b]$.

The proof of this theorem is quite complex, but it can be done using the $\varepsilon$-$\delta$ definition of a limit.

1. **Definitions**
    - **Partition**: A partition $P$ of $[a, b]$ is a finite set of points $x_0, x_1, \cdots, x_n$ such that $a = x_0 < x_1 < \cdots < x_n = b$.
    - **Mesh**: The mesh of a partition $P$ is the maximum length of the subintervals $[x_{i - 1}, x_i]$, denoted as $\|P\| = \max_{i} (x_i - x_{i - 1}) \text{ for } i = 1, 2, \cdots, n$.
    - **Riemann Sum**: For a given partition $P$ and a set of points $t_i \in [x_{i - 1}, x_i]$, the Riemann sum of $f$ over $P$ is:

            $$
            R(f, P, \{t_i\}) = \sum f(t_i) (x_i - x_{i - 1})
            $$

    These definitions are a formalization of the Riemann sum we have been discussing. What it's saying is that you can choose any intervals inside $[a, b]$, then choose any point as the height of the rectangle, and the sum of all the areas of the rectangles will be the Riemann sum.
    This definition helps because it is independent of the type of the Riemann sum.
2. **Continuity**
    - Since $f$ is continuous on $[a, b]$, it is **uniformly continuous** on $[a, b]$. Hence, for any $\varepsilon > 0$, there exists a $\delta > 0$ such that for any $x, y \in [a, b]$ where $|x - y| < \delta$, $|f(x) - f(y)| < \varepsilon$.
3. **Convergence**
    - Let $\varepsilon > 0$ be given. Since $f$ is uniformly continuous on $[a, b]$, choose $\delta > 0$ such that for any $x, y \in [a, b]$ where $|x - y| < \delta$, $|f(x) - f(y)| < \frac{\varepsilon}{b - a}$.
    - Next, let $P$ be a partition of $[a, b]$ with mesh $\|P\| < \delta$. This is possible because the mesh of the partition can be made arbitrarily small.
    - For each subinterval $[x_{i - 1}, x_i]$ of the partition, choose a point $t_i \in [x_{i - 1}, x_i]$.
    - The difference between the Riemann sum and the definite integral can be evaluated as follows:

            $$
            \begin{equation}
            \begin{split}
            \left|R(f, P, t) - \int_{a}^{b} f(x)\dd{x} \right| &= \left|\sum f(t_i) (x_i - x_{i - 1}) - \int_{a}^{b} f(x)\dd{x} \right| \\
            &= \left|\sum f(t_i) (x_i - x_{i - 1}) - \sum f(x) (x_i - x_{i - 1}) \right| \\
            &= \left|\sum (f(t_i) - f(x)) (x_i - x_{i - 1}) \right| \\
            &\leq \sum |f(t_i) - f(x)| (x_i - x_{i - 1}) \\
            \end{split}
            \end{equation}
            $$

    The proof uses the Mean Value Theorem (MVT). For a continuous function $f$ on $[a, b]$, there exists a point $x \in [x_{i - 1}, x_i]$ such that $\int_{x_{i - 1}}^{x_i} f(x)\dd{x} = f(x) (x_i - x_{i - 1})$.
    Next, since the width of each interval $x_i - x_{i - 1}$ is less than $\delta$, $c_i - x < \delta$, and by uniform continuity, $|f(c_i) - f(x)| < \frac{\varepsilon}{b - a}$. Therefore:

            $$
            \begin{equation}
            \begin{split}
            \left|R(f, P, t) - \int_{a}^{b} f(x)\dd{x} \right| &\leq \sum |f(t_i) - f(x)| (x_i - x_{i - 1}) \\
            &\leq \sum \frac{\varepsilon}{b - a} (x_i - x_{i - 1}) \\
            &= \frac{\varepsilon}{b - a} \sum (x_i - x_{i - 1}) \\
            &= \varepsilon
            \end{split}
            \end{equation}
            $$

    As such, in conclusion, for any $\varepsilon > 0$, there exists a $\delta > 0$ such that for any partition $P$ with mesh $\|P\| < \delta$, $|R(f, P, t) - \int_{a}^{b} f(x)\dd{x}| < \varepsilon$. This is the definition of a limit, and hence the Riemann sum converges to the integral.

    Hence:

    $$
    \begin{equation}
    \int_{a}^{b} f(x)\dd{x} = \lim_{\|P\| \to 0} R(f, P, t)
    \end{equation}
    $$

:::

For example, consider this integral:

$$
\begin{equation}
\int_{0}^{3} x(5 - x) \dd{x}
\end{equation}
$$

Let's go through our steps:

1. **Identify $\Delta t$**. Since the interval is $[0, 3]$, $\Delta t = \frac{3 - 0}{n} = \frac{3}{n}$.
2. **Identify $t_i$**. $t_i = 0 + i \Delta t = \frac{3i}{n}$.
3. **Identify the area of each $i$th rectangle**. The area of each rectangle is $v(t_i) \Delta t = \frac{3i}{n} \qty(5 - \frac{3i}{n}) \frac{3}{n} = \frac{9}{n^3} i(5n - 3i) $.

Therefore, the Riemann sum is:

$$
\begin{equation}
\begin{split}
\text{Area} &= \sum_{i = 0}^{n - 1} \frac{9}{n^3} i(5n - 3i) \\
&= \frac{9}{n^3} \sum_{i = 0}^{n - 1} i(5n - 3i)
\end{split}
\end{equation}
$$

And the area under the curve is:

$$
\begin{equation}
\int_{0}^{3} x(5 - x) \dd{x} = \lim_{n \to \infty} \frac{9}{n^3} \sum_{i = 0}^{n - 1} i(5n - 3i)
\end{equation}
$$

## Accumulation Functions: Functions Defined by Integrals

A function can be defined by an integral. For example, consider the following function:

$$
\begin{equation}
f(x) = \int_{-4}^{x} t^2 \dd{t}
\end{equation}
$$

This is known as an accumulation function. The reason it's called an accumulation function is because of what we've discussed above; treating integrals as an accumulation of areas.

The derivative of an accumulation function can be derived using the fundamental theorem of calculus:

$$
\begin{equation}
\begin{split}
\dv{f}{x}(x) &= \dv{x} \int_{-4}^{x} t^2 \dd{t} \\
&= x^2
\end{split}
\end{equation}
$$

Sometimes the upper bound of the integral isn't just $x$, but a function of $x$. For example:

$$
\begin{equation}
f(x) = \int_{-4}^{\sin(x)} t^2 \dd{t}
\end{equation}
$$

The derivative of this function can be found using the chain rule. Set another function $u(x)$ as:

$$
\begin{equation}
\begin{split}
u(x) &= \int_{-4}^{x} t^2 \dd{t} \\
\dv{u}{x}(x) &= x^2
\end{split}
\end{equation}
$$

And set $v(x) = \sin(x)$:

$$
\begin{equation}
\begin{split}
v(x) &= \sin(x) \\
\dv{v}{x}(x) &= \cos(x)
\end{split}
\end{equation}
$$

Therefore, the derivative of $f(x)$ is:

$$
\begin{equation}
\begin{split}
\dv{f}{x}(x) &= \dv{x} u(v(x)) \\
&= \dv{u}{v} \dv{v}{x} \\
&= v^2 \cos(x) \\
&= \sin^2(x) \cos(x)
\end{split}
\end{equation}
$$

Generalizing this, the derivative of an accumulation function with a variable upper bound is:

$$
\begin{equation}
\dv{x} \int_{a}^{g(x)} f(t) \dd{t} = \dv{g}{x}(x) f(g(x))
\end{equation}
$$

Many functions are defined using integrals because they are easier to work with, and some cannot be expressed in terms of elementary functions.

A common example is the error function:

$$
\begin{equation}
\text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} \dd{t}
\end{equation}
$$

The error function is used in statistics and probability theory, and is used to calculate the probability of a random variable falling within a certain range.

Another common example is the gamma function:

$$
\begin{equation}
\Gamma(x) = \int_{0}^{\infty} t^{x - 1} e^{-t} \dd{t}
\end{equation}
$$

<Mafs>
    <Coordinates.Cartesian/>
    <Plot.OfX
        y={gamma}
    />
</Mafs>

The gamma function is a generalization of the factorial function, and is used in many areas of mathematics.

### Behavior of Accumulation Functions

The behavior of accumulation functions can be quite complex. For example, consider the following function:

$$
f(x) = -x(x - 6)
$$

<Mafs
    viewBox={{
        x: [-1, 9],
        y: [-1, 9]
    }}
>
    <Coordinates.Cartesian/>
    <Plot.OfX
        y={(x) => -x * (x - 6)}
    />
</Mafs>

And let $g(x)$ be the accumulation function of $f(x)$:

$$
g(x) = \int_{0}^{x} f(t) \dd{t}
$$

Because of the fundamental theorem of calculus, the derivative of $g(x)$ is $f(x)$. Using this, we can use $f$ to derive the behavior of $g$.

For example, at $x = 0, x = 6$, $f(x) = 0$, so those are the critical points of $g(x)$.
At $x \in (0, 6)$, $f(x) > 0$, so $g(x)$ is increasing.

At $x \in (6, \infty)$, $f(x) < 0$, so $g(x)$ is decreasing.

## Properties of Definite Integrals

Since integrals are the accumulation of areas; the continuous analog of the sum, they have many properties that are similar to sums.

### Variable Notation

The variable of integration can be anything. For example, the following two integrals are equivalent:

$$
\begin{equation}
\int_{0}^{3} x(5 - x) \dd{x} = \int_{0}^{3} t(5 - t) \dd{t}
\end{equation}
$$

With this in mind; sometimes variables can be confusing.
Consider a problem where we have the velocity of a particle $v(t)$ and we want to find the position of the particle $s(t)$ at time $t$.

$$
\begin{equation}
s(t) = \int_{0}^{t} v(t) \dd{t}
\end{equation}
$$

Here, while it seems like we only have $t$ as a variable, we actually have two variables:

- The upper bound of the integral, which is a specific value.
- The variable of integration, which is a dummy variable that is used to represent the function.

One way to get around this is to use a different variable for the variable of integration, like $t'$:

$$
\begin{equation}
s(t) = \int\limits_{t' = 0}^{t' = t} v(t') \dd{t'}
\end{equation}
$$

This is common in physics and engineering.

### Signs

When the area is above the $x$-axis, it is positive. When the area is below the $x$-axis, it is negative.

If the upper bound is less than the lower bound, you sort of "go backwards" and the entire integral is negated.

As such,

$$
\int_{a}^{b} f(x) \dd{x} = -\int_{b}^{a} f(x) \dd{x}
$$

This can also be shown through the Riemann sum. Consider the Riemann sum for each integral:

$$
\begin{equation}
\begin{split}
\int_{a}^{b} f(x) \dd{x} &= \lim_{n \to \infty} \sum_{i = 0}^{n - 1} f(a + i \Delta x) \Delta x \\
\int_{b}^{a} f(x) \dd{x} &= \lim_{n \to \infty} \sum_{i = 0}^{n - 1} f(b + i \Delta x) \Delta x
\end{split}
\end{equation}
$$

Let's think about what $\Delta x$ is. Recall that $\Delta x = \frac{\text{Upper Bound} - \text{Lower Bound}}{n}$.

Hence, for the first integral, $\Delta x = \frac{b - a}{n}$, and for the second integral, $\Delta x = \frac{a - b}{n}$.

Since $a - b = -(b - a)$, the Riemann sum for the second integral is the negation of the Riemann sum for the first integral.

Another way to show this is through the fundamental theorem of calculus. Recall that for a function $F(x)$ with derivative $f(x)$, the integral of $f(x)$ from $a$ to $b$ is $F(b) - F(a)$.

If we flip it:

$$
\int_{b}^{a} f(x) \dd{x} = F(a) - F(b) = -(F(b) - F(a)) = -\int_{a}^{b} f(x) \dd{x}
$$

One application of this is to evaluate accumulation functions where the function parameter is on the lower bound. For example:

$$
f(x) = \int_{x}^{3} t(5 - t) \dd{t}
$$

This can be rewritten as:

$$
f(x) = -\int_{3}^{x} t(5 - t) \dd{t}
$$

### Linearity

Let's think about the integral of a sum of functions:

$$
\int_{a}^{b} (f(x) + g(x)) \dd{x}
$$

Where $f(x) = x(5 - x)$ and $g(x) = x + sin(x)$.

The graph for $f(x)$ and $f(x) + g(x)$ is shown below:

<Mafs
    viewBox={{
        x: [-1, 10],
        y: [-1, 10]
    }}
>
    <Coordinates.Cartesian/>
    <Plot.OfX
        y={(x) => x * (5 - x)}
    />
    <Plot.OfX
        y={(x) => x * (5 - x) + Math.sin(x) + x}
    />
</Mafs>

If we once again consider the Riemann sum, we can split the integral into separate rectangles:

<Mafs
    viewBox={{
        x: [-1, 10],
        y: [-1, 10]
    }}
>
    <Coordinates.Cartesian/>
    <RiemannApproximation
        f={(x) => x * (5 - x) + Math.sin(x) + x}
        lb={0}
        ub={3}
        n={5}
    />
    <RiemannApproximation
        f={(x) => x * (5 - x)}
        lb={0}
        ub={3}
        n={5}
    />
</Mafs>

Notice how the rectangle for $f(x) + g(x)$ is the sum of the rectangles for $f(x)$ and $g(x)$. Therefore we can intuitively say that:

$$
\int_{a}^{b} (f(x) + g(x)) \dd{x} = \int_{a}^{b} f(x) \dd{x} + \int_{a}^{b} g(x) \dd{x}
$$

This is known as the linearity of integrals.

### Singular Points

The integral of a function at a singular point is $0$.

For example, consider the function $f(x) = \frac{1}{x}$:

<Mafs
    viewBox={{
        x: [-1, 10],
        y: [-1, 10]
    }}
>
    <Coordinates.Cartesian/>
    <Plot.OfX
        y={(x) => 1 / x}
    />
    <Line.Segment
        point1={[2, 0]}
        point2={[2, 1 / 2]}
        color={color("red")}
    />
</Mafs>

The integral of $f(x)$ from $2$ to $2$ is $0$ because there's no width at all.

### Scaling

If you scale a function by a constant, then the integral is scaled by that constant.

Consider the function $f(x) = \sin(x)$, and $g(x) = \frac{5}{2}\sin(x)$:

<Mafs
    viewBox={{
        x: [-3, 3],
        y: [-3, 3]
    }}
>
    <Coordinates.Cartesian/>
    <Plot.OfX
        y={(x) => Math.sin(x)}
    />
    <Plot.OfX
        y={(x) => 2.5 * Math.sin(x)}
        color={color("blue")}
    />
</Mafs>

Now let's consider the integral of $f(x)$ and $g(x)$ from $0$ to $\pi$:

<Mafs
    viewBox={{
        x: [-3, 3],
        y: [-3, 3]
    }}
>
    <Coordinates.Cartesian/>
    <RiemannApproximation
        f={(x) => Math.sin(x)}
        lb={0}
        ub={Math.PI}
        n={5}
    />
    <RiemannApproximation
        f={(x) => 2.5 * Math.sin(x)}
        lb={0}
        ub={Math.PI}
        n={5}
        color={color("blue")}
    />
</Mafs>

Notice how, once again, the rectangle for $g(x)$ is scaled by $2.5$ compared to the rectangle for $f(x)$.

Therefore, we can say that:

$$
\int_{a}^{b} k f(x) \dd{x}= k \int_{a}^{b} f(x) \dd{x}
$$

### Adjacency

Consider a function $f(x) = \sqrt{x}$:

<Mafs
    viewBox={{
        x: [-1, 3],
        y: [-1, 3]
    }}
>
    <Coordinates.Cartesian/>
    <Plot.OfX
        y={(x) => Math.sqrt(x)}
    />
    <Plot.Inequality
        y={{
            "<=": (x) => (x > 0 && x < 1) ? Math.sqrt(x) : -50,
            ">=": (x) => 0
        }}
        color={color("red")}
    />
    <Plot.Inequality
        y={{
            "<=": (x) => (x > 1 && x < 4) ? Math.sqrt(x) : -50,
            ">=": (x) => 0
        }}
        color={color("blue")}
    />
</Mafs>

Notice how if you add the areas for $f(x)$ from $0$ to $1$ and $1$ to $4$, you get the area for $f(x)$ from $0$ to $4$.

Therefore, we can say that:

$$
\int_{a}^{b} f(x) \dd{x}= \int_{a}^{c} f(x) \dd{x}+ \int_{c}^{b} f(x) \dd{x}
$$

Note that $c$ does not have to be in the interval $[a, b]$. A way to show this is through the fundamental theorem of calculus. Let $F(x)$ be the antiderivative of $f(x)$:

$$
\begin{equation}
\begin{split}
\int_{a}^{b} f(x) \dd{x}&= F(b) - F(a) \\
&= F(c) - F(a) + F(b) - F(c) \\
&= \int_{a}^{c} f(x) \dd{x}+ \int_{c}^{b} f(x) \dd{x}
\end{split}
\end{equation}
$$

Notice how this does not depend on the value of $c$.

### Example Problem: Input on Both Bounds

> Consider the following accumulation function:
>
> $$
> f(x) = \int_{x}^{x^2} t^2 \cos(t) \dd{t}
> $$
>
> Identify the derivative of $f(x)$.

Let's first rewrite the accumulation function using Adjacency.

$$
f(x) = \int_{x}^{x^2} t^2 \cos(t) \dd{t}= \int_{x}^{c} t^2 \cos(t) \dd{t}+ \int_{c}^{x^2} t^2 \cos(t) \dd{t}
$$

Next, consider the first integral. $x$ is on the bottom, so we can flip the integral to move it to the top:

$$
\int_{x}^{c} t^2 \cos(t) \dd{t}= -\int_{c}^{x} t^2 \cos(t) \dd{t}
$$

Thus, the accumulation function can be rewritten as:

$$
f(x) = -\int_{c}^{x} t^2 \cos(t) \dd{t}+ \int_{c}^{x^2} t^2 \cos(t) \dd{t}
$$

The derivative of $f(x)$ can be found using the fundamental theorem of calculus and the chain rule:

$$
\begin{equation}
\begin{split}
\dv{f}{x}(x) &= -\dv{x} \int_{c}^{x} t^2 \cos(t) \dd{t} + \dv{x} \int_{c}^{x^2} t^2 \cos(t) \dd{t} \\
&= -x^2 \cos(x) + 2x(x^2 \cos(x^2)) \\
&= -x^2 \cos(x) + 2x^3 \cos(x^2)
\end{split}
\end{equation}
$$

### Cheat Sheet of Properties

Here is a cheat sheet of the properties of definite integrals:

| Property | Formula |
|----------|---------|
| Signs | $\int_{a}^{b} f(x) \dd{x} = -\int_{b}^{a} f(x) \dd{x}$ |
| Linearity | $\int_{a}^{b} (f(x) + g(x)) \dd{x} = \int_{a}^{b} f(x) \dd{x} + \int_{a}^{b} g(x) \dd{x}$ |
| Singular Points | $\int_{a}^{a} f(x) \dd{x} = 0$ |
| Scaling | $\int_{a}^{b} k f(x) \dd{x} = k \int_{a}^{b} f(x) \dd{x}$ |
| Adjacency | $\int_{a}^{b} f(x) \dd{x} = \int_{a}^{c} f(x) \dd{x} + \int_{c}^{b} f(x) \dd{x}$ |

## Common Antiderivatives

Since the derivative of an antiderivative is the original function, we can use this to compute antiderivatives.

We've already gone over the intuition for many derivatives. Here are some common antiderivatives:

{/* | Function | Antiderivative |
|----------|----------------|
| $x^n$ | $\frac{x^{n + 1}}{n + 1} + C$ |
| $\sin(x)$ | $-\cos(x) + C$ |
| $\cos(x)$ | $\sin(x) + C$ |
| $e^x$ | $e^x + C$ |
| $\frac{1}{x}$ | $\ln|x| + C$ | */}
{/* use a html table instead*/}

<table>
    <thead>
        <tr>
            <th>Function</th>
            <th>Antiderivative</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <MathEquation>x^n</MathEquation>
            </td>
            <td>
                <MathEquation>{"\\frac{x^{n + 1}}{n + 1} + C"}</MathEquation>
            </td>
        </tr>
        <tr>
            <td>
                <MathEquation>\sin(x)</MathEquation>
            </td>
            <td>
                <MathEquation>-\cos(x) + C</MathEquation>
            </td>
        </tr>
        <tr>
            <td>
                <MathEquation>\cos(x)</MathEquation>
            </td>
            <td>
                <MathEquation>\sin(x) + C</MathEquation>
            </td>
        </tr>
        <tr>
            <td>
                <MathEquation>e^x</MathEquation>
            </td>
            <td>
                <MathEquation>e^x + C</MathEquation>
            </td>
        </tr>
        <tr>
            <td>
                <MathEquation>{"\\frac{1}{x}"}</MathEquation>
            </td>
            <td>
                <MathEquation>{"\\ln|x| + C"}</MathEquation>
            </td>
        </tr>
    </tbody>
</table>

## Reversing the Chain Rule

Sometimes, the antiderivative of a function is not immediately obvious. In such cases, substitution can be used.

The first type of substitution is the $u$-substitution, which is basically the chain rule in reverse. Consider the following integral:

$$
\int 2x \cos(x^2 + 3) \dd{x}
$$

Now, there's two ways to do this. The first way is to use the chain rule in reverse, and the second way is to use $u$-substitution.
$u$-substitution tends to be _much_ easier, but reverse chain rule lets you do it a lot faster.

### Reverse Chain Rule

Recall the chain rule:

$$
\dv{x} f(g(x)) = \dv{f}{g} \dv{g}{x}
$$

We have a composite function $\cos(x^2 + 3)$, and the derivative of $x^2 + 3$ is $2x$. As such we have all the components of the chain rule:

$$
\overbrace{2x}^{\dd{g}/\dd{x}} \mathrlap{\underbrace{\phantom{\cos(x^2 + 3)}}_{\dd{f}/\dd{g}}} \cos(\overbrace{x^2 + 3}^{g(x)}) = \dv{g}{x} \dv{f}{g}
$$

In this case $\dv{f}{g}$ is $\cos(g)$, so $f(g)$ is $\sin(g)$. By reversing the chain rule, the antiderivative is:

$$
\int 2x \cos(x^2 + 3) \dd{x} = f(g(x)) + C = \sin(x^2 + 3) + C
$$

### $u$-Substitution

We have a composite function $\cos(x^2 + 3)$, and the derivative of $x^2 + 3$ is $2x$. As such, we can let $u = x^2 + 3$:

$$
\begin{align}
u &= x^2 + 3 \\
\dv{u}{x} &= 2x \\
\dd{u} &= 2x \dd{x} \\
\end{align}
$$

Hence, the integral can be rewritten as:

$$
\int 2x \cos(x^2 + 3) \dd{x} = \int \cos(u) \dd{u} = \sin(u) + C = \sin(x^2 + 3) + C
$$

### $u$-Substitution in Definite Integrals

$u$-substitution can also be used in definite integrals. Consider the following integral:

$$
\int_{0}^{\pi} \frac{4x}{\ln(x^2 + 5)} \dd{x}
$$

This can be solved by letting $u = x^2 + 5$ and $\dd{u} = 2x \dd{x}$:

$$
\int_{0}^{\pi} \frac{4x}{x^2 + 5} \dd{x} = \int_{0}^{\pi} \frac{2}{\ln(u)} \dd{u}
$$

**BUT WAIT!** We changed the function from $x$ to $u$, so we need to change the bounds as well.
The bounds are $x = 0$ and $x = \pi$, so when $x = 0$, $u = 5$, and when $x = \pi$, $u = \pi^2 + 5$.

Therefore the new bounds should be $5$ and $\pi^2 + 5$:

$$
\int_{0}^{\pi} \frac{4x}{x^2 + 5} \dd{x} = \int_{5}^{\pi^2 + 5} \frac{2}{\ln(u)} \dd{u}
$$

It's clearer if we label the variables in the bounds as well:

$$
\int\limits_{x = 0}^{x = \pi} \frac{4x}{x^2 + 5} \dd{x} = \int\limits_{x = 0}^{x = \pi} \frac{2}{\ln(u)} \dd{u} = \int\limits_{u = 5}^{u = \pi^2 + 5} \frac{2}{\ln(u)} \dd{u}
$$

## Integration by Long Division

Long division, a technique you may have learned in elementary school, can also be used in algebra.
The difference is that instead of dividing numbers, you are dividing polynomials.

For example, consider the following integral:

$$
\int \frac{x^2 + 3x + 2}{x + 1} \dd{x}
$$

The first step is to divide $x^2 + 3x + 2$ by $x + 1$.
Recall from elementary school that you find the largest multiple of the quotient in the highest place value.
Here, instead of the highest place value, you are looking at the highest degree term, $x^2$.

The largest multiple of $x$ in $x^2$ is $x$, so you multiply $x + 1$ by $x$ to get $x^2 + x$.
$$
\begin{array}{rl}
& x \\
x + 1 & \mathrlap{\mkern{-0.5em})} \overline{x^2 + 3x + 2} \\
& x^2 + x \\
& \overline{\phantom{x^2 + }2x + 2} \\
\end{array}
$$

You get a remainder of $2x + 2$. Repeat the process; find the largest multiple of $x$ in $2x$ - it's $2$.

$$
\begin{array}{rl}
& x + 2 \\
x + 1 & \mathrlap{\mkern{-0.5em})} \overline{x^2 + 3x + 2} \\
& x^2 + x \\
& \overline{\phantom{x^2 + }2x + 2} \\
& \phantom{x^2 + }2x + 2 \\
& \overline{\phantom{x^2 + 3x + }0} \\
\end{array}
$$

As such, the integral can be rewritten as:

$$
\int \frac{x^2 + 3x + 2}{x + 1} \dd{x} = \int (x + 2) \dd{x} = \frac{x^2}{2} + 2x + C
$$

### Example Problem: Integration by Long Division

> Evaluate the following integral:
>
> $$
> \int \frac{x - 5}{-2x + 2} \dd{x}
> $$

Once again, we can use long division to divide $x - 5$ by $-2x + 2$.

The highest-degree term in $x - 5$ is $x$. Hence to get $x$, multiply $-2x + 2$ by $-\frac{1}{2}$:

$$
\begin{array}{rl}
& \mkern{-0.8em}-\frac{1}{2} \\
-2x + 2 & \mathrlap{\mkern{-0.5em})} \overline{x - 5} \\
& x - 1 \\
& \overline{\phantom{x } - 4} \\
\end{array}
$$

This time we have a remainder of $-4$. Once again, recall from elementary school that you can express $\frac{number}{divisor}$ as $\text{quotient} + \frac{\text{remainder}}{\text{divisor}}$.
For example $7 = 3 + \frac{1}{2}$. Hence, the integral can be rewritten as:

$$
\begin{equation}
\begin{split}
\int \frac{x - 5}{-2x + 2} \dd{x} &= \int \qty(-\frac{1}{2} + \frac{-4}{-2x + 2}) \dd{x} \\
&= \int \qty(-\frac{1}{2} + \frac{2}{x - 1}) \dd{x} \\
\end{split}
\end{equation}
$$

The integral of $-\frac{1}{2}$ is $-\frac{x}{2}$, and the integral of $\frac{2}{x - 1}$ can be found using $u$-substitution:

$$
\begin{equation}
\begin{split}
u &= x - 1 \\
\dd{u} &= \dd{x} \\
\int \frac{2}{x - 1} \dd{x} &= 2 \int \frac{1}{u} \dd{u} = 2 \ln|u| + C = 2 \ln|x - 1| + C
\end{split}
\end{equation}
$$

Therefore, the integral is:

$$
\int \frac{x - 5}{-2x + 2} \dd{x} = -\frac{x}{2} + 2 \ln|x - 1| + C
$$

## Integration by Completing the Square

Completing the square is a technique used to solve quadratic equations. It can also be used in integration.

For example, consider the following integral:

$$
\int \frac{1}{2x^2 + 8x + 12} \dd{x}
$$

The first step is to complete the square in the denominator. Recall that to complete the square, you need to find the value that makes the square a perfect square trinomial.

We will first need to remove the coefficient of $x^2$ by factoring out $\frac{1}{2}$:

$$
\int \frac{1}{2x^2 + 8x + 12} \dd{x} = \frac{1}{2} \int \frac{1}{x^2 + 4x + 6} \dd{x}
$$

Next, complete the square in the denominator.

$$
\frac{1}{2} \int \frac{1}{x^2 + 4x + 6} \dd{x} = \frac{1}{2} \int \frac{1}{x^2 + 4x + 4 + 2} \dd{x} = \frac{1}{2} \int \frac{1}{(x + 2)^2 + 2} \dd{x}
$$

Now, let's factor out the $2$ in the denominator:

$$
\frac{1}{2} \int \frac{1}{(x + 2)^2 + 2} \dd{x} = \frac{1}{4} \int \frac{1}{\qty(\frac{x + 2}{\sqrt{2}})^2 + 1} \dd{x}
$$

Now, let $u = \frac{x + 2}{\sqrt{2}}$:

$$
\begin{equation}
\begin{split}
u &= \frac{x + 2}{\sqrt{2}} \\
\dd{u} &= \frac{1}{\sqrt{2}} \dd{x} \\
\sqrt{2} \dd{u} &= \dd{x}
\end{split}
\end{equation}
$$

We need to get the $\sqrt{2}\dd{x}$ to match $\dd{u}$. Therefore, multiply the numerator by $\sqrt{2}$ and divide the fraction outside by $\sqrt{2}$:

$$
\frac{1}{4} \int \frac{1}{\qty(\frac{x + 2}{\sqrt{2}})^2 + 1} \dd{x} = \frac{1}{4 \sqrt{2}} \int \frac{\sqrt{2}}{\qty(\frac{x + 2}{\sqrt{2}})^2 + 1} \dd{x} = \frac{1}{4 \sqrt{2}} \int \frac{1}{u^2 + 1} \dd{u}
$$

The integral of $\frac{1}{u^2 + 1}$ is $\arctan(u) + C$. Therefore, the integral is:

$$
\begin{equation}
\begin{split}
\frac{1}{4 \sqrt{2}} \int \frac{\sqrt{2}}{\qty(\frac{x + 2}{\sqrt{2}})^2 + 1} \dd{x} = \frac{1}{4 \sqrt{2}} \int \frac{1}{u^2 + 1} \dd{u} = \frac{1}{4 \sqrt{2}} \arctan(u) + C = \frac{1}{4 \sqrt{2}} \arctan\qty(\frac{x + 2}{\sqrt{2}}) + C
\end{split}
\end{equation}
$$

## Integration by Parts

Integration by parts is a technique used to integrate the product of two functions.

Let's say we have $f(x)$ and $g(x)$ whose derivatives are $f'(x)$ and $g'(x)$ respectively. The product rule states that:

$$
\begin{equation}
\dv{x} f(x)g(x) = f'(x)g(x) + f(x)g'(x)
\end{equation}
$$

Integrating both sides with respect to $x$:

$$
\begin{equation}
f(x)g(x) = \int f'(x)g(x) \dd{x} + \int f(x)g'(x) \dd{x}
\end{equation}
$$

Rearranging the equation, we get:

$$
\begin{equation}
\int f(x)g'(x) \dd{x} = f(x)g(x) - \int f'(x)g(x) \dd{x} \label{eq:integration_by_parts}
\end{equation}
$$

This is the formula for integration by parts. The idea is to choose $f(x)$ and $g'(x)$ such that the integral on the right-hand side is easier to solve than the integral on the left-hand side.

### Example Problem: Integration by Parts - $x \cos(x)$

> Evaluate the following integral:
>
> $$
> \begin{equation}
> \int x \cos(x) \dd{x} \label{eq:example_problem_integration_by_parts_xcosx}
> \end{equation}
> $$

We have a product of $x$ and $\cos(x)$. Determining which is $f(x)$ and which is $g'(x)$ comes down to the right hand side, specifically $\int f'(x)g(x)\dd{x}$.

Therefore, we assign $f(x)$ such that $f'(x)$ is easy, and asssign $g'(x)$ such that $g(x)$ is easy.

Choose $f(x) = x$ because $f'(x) = 1$, and choose $g'(x) = \cos(x)$ because $g(x) = \sin(x)$.

Plugging into $\eqref{eq:example_problem_integration_by_parts_xcosx}$ and using $\eqref{eq:integration_by_parts}$:

$$
\begin{equation}
\begin{split}
\int \class{red}{\overbrace{x}^{f(x)}} \class{blue}{\underbrace{\cos(x)}_{g'(x)}} \dd{x} &= \class{red}{f(x)}\class{blue}{g(x)} - \int \class{red}{f'(x)}\class{blue}{g(x)} \dd{x} \\
&= \class{red}{x}\class{blue}{\sin(x)} - \int \class{blue}{\sin(x)} \dd{x} \\
&= \class{red}{x}\class{blue}{\sin(x)} + \class{blue}{\cos(x)} + C
\end{split}
\end{equation}
$$

### Example Problem: Integration by Parts - $\ln(x)$

> Evaluate the following integral:
>
> $$
> \begin{equation}
> \int \ln(x) \dd{x} \label{eq:example_problem_integration_by_parts_lnx}
> \end{equation}
> $$

Integration by Parts works for products of two functions, but this is a singular function!

However, you can add another term simply by multiplying by $1$:

$$
\begin{equation}
\int \ln(x) \dd{x} = \int (\ln(x))\cdot 1 \dd{x} \label{eq:example_problem_integration_by_parts_lnx-mul1}
\end{equation}
$$

We assign $f(x)$ such that $f'(x)$ is easy, and asssign $g'(x)$ such that $g(x)$ is easy.

Choose $f(x) = \ln(x)$ because $f'(x) = 1/x$, and choose $g'(x) = 1$ because $g(x) = x$.

Plugging into $\eqref{eq:example_problem_integration_by_parts_lnx-mul1}$ and using $\eqref{eq:integration_by_parts}$:

$$
\begin{equation}
\begin{split}
\int \class{red}{\overbrace{\ln(x)}^{f(x)}} \class{blue}{\underbrace{(1)}_{g'(x)}} \dd{x} &= \class{red}{f(x)}\class{blue}{g(x)} - \int \class{red}{f'(x)}\class{blue}{g(x)} \dd{x} \\
&= \class{red}{\ln(x)}\class{blue}{x} - \int \class{red}{\frac{1}{x}}\class{blue}{x} \dd{x} \\
&= \class{red}{\ln(x)}\class{blue}{x} - x + C \\
&= x(\ln(x) - 1) + C
\end{split}
\end{equation}
$$

### Example Problem: Integration by Parts - $x^2 e^x$

> Evaluate the following integral:
>
> $$
> \begin{equation}
> \int x^2 e^x \dd{x} \label{eq:example_problem_integration_by_parts_x2ex}
> \end{equation}
> $$

We shall first use Integration by Parts like before:

$$
\begin{equation}
\begin{split}
\int \class{red}{\overbrace{x^2}^{f(x)}} \class{blue}{\underbrace{e^x}_{g'(x)}} \dd{x} &= \class{red}{f(x)}\class{blue}{g(x)} - \int \class{red}{f'(x)}\class{blue}{g(x)} \dd{x} \\
&= \class{red}{x^2}\class{blue}{e^x} - \int \class{red}{2x}\class{blue}{e^x} \dd{x} \\
\end{split}
\end{equation}
$$

The integral on the right can be solved using Integration by Parts again:

$$
\begin{equation}
\begin{split}
\int x^2 e^x \dd{x} &= \class{red}{x^2}\class{blue}{e^x} - 2\int \class{green}{\overbrace{x}^{u(x)}} \class{yellow}{\underbrace{e^x}_{v'(x)}} \dd{x} \\
&= \class{red}{x^2}\class{blue}{e^x} - 2\qty(\class{green}{u(x)}\class{yellow}{v(x)} - \int \class{green}{u'(x)}\class{yellow}{v(x)} \dd{x}) \\
&= \class{red}{x^2}\class{blue}{e^x} - 2\qty(\class{green}{x}\class{yellow}{e^x} - \int \class{green}{1}\class{yellow}{e^x} \dd{x} ) \\
&= \class{red}{x^2}\class{blue}{e^x} - \class{green}{2x}\class{yellow}{e^x} + \class{yellow}{2e^x} + C \\
&= e^x(x^2 - 2x + 2) + C \\
\end{split}
\end{equation}
$$

## Integration through Trigonometric Substitution

Trigonometric Substitution is another way to substitute variables to make integration easier.

### Trigonometric Substitution with Sine

Consider this integral:

$$
\begin{equation}
\int \frac{1}{\sqrt{a^2 - x^2}}\dd{x} \label{eq:trigonometric_substitution_with_sine-first}
\end{equation}
$$

Using our current understanding, it would be very difficult to solve this integral. However, looking at the radical in the denominator, it looks very similar to the Pythagorean Theorem.
Therefore, we can construct a right triangle to visualize this:

{(() => {
    const p1 = [-2, -2], p2 = [3, -2], p3 = [3, 2];
    return (
        <Mafs>
            <Line.Segment
                point1={p1}
                point2={p2}
                color={color("red")}
            />

            <Line.Segment
                point1={p2}
                point2={p3}
                color={color("yellow")}
            />
            <LaTeX
                tex={"x"}
                at={lineLabel(p2, p3, "right")}
                color={color("yellow")}
            />

            <Line.Segment
                point1={p3}
                point2={p1}
                color={color("green")}
            />
            <LaTeX
                tex={"a"}
                at={lineLabel(p1, p3, "left")}
                color={color("green")}
            />

            <Angle
                at={p2}
                fromRad={Math.PI / 2}
                toRad={Math.PI}
            />
            <Angle
                at={p1}
                fromRad={0}
                toRad={Math.atan((p3[1] - p2[1]) / (p2[0] - p1[0]))}
                label="\theta"
            />
        </Mafs>
    );
})()}

Through the Pythagorean Theorem, the red line is $\sqrt{a^2 - x^2}$, which is the denominator of the expression in Equation $\eqref{eq:trigonometric_substitution_with_sine-first}$.

Set angle $\theta$ to be the opposite of $\class{yellow}{x}$. As such,

$$
\begin{align}
\sin(\theta) &= \frac{\text{opp}}{\text{hyp}} = \frac{\class{yellow}{x}}{\class{green}{a}} \\
\class{yellow}{x} &= \class{green}a \sin(\theta) \label{eq:trigonometric_substitution_with_sine-first-x-def} \\
\cos(\theta) &= \frac{\text{adj}}{\text{hyp}} = \frac{\class{red}{\sqrt{a^2 - x^2}}}{\class{green}{a}} \\
\class{red}{\sqrt{a^2 - x^2}} &= \class{green}a \cos(\theta) \label{eq:trigonometric_substitution_with_sine-first-radical-def}
\end{align}
$$

We have derived the fact that $\class{yellow}{x} = \class{green}{a} \sin(\theta)$. Differentiating both sides w.r.t $\theta$ (just like we did with $u$-substitution),

$$
\begin{equation}
d\class{yellow}{x} = \class{green}{a} \cos(\theta) \dd{\theta} \label{eq:trigonometric_substitution_with_sine-first-dx-def}
\end{equation}
$$

Take the original integral $\eqref{eq:trigonometric_substitution_with_sine-first}$ and substitute Equation $\eqref{eq:trigonometric_substitution_with_sine-first-dx-def}$ into it:

$$
\begin{equation}
\int \frac{1}{\sqrt{a^2 - x^2}}\class{blue}{\dd{x}} = \int \frac{\class{blue}{a \cos(\theta)}}{\sqrt{a^2 - x^2}}\class{blue}{\dd{\theta}}
\end{equation}
$$

Then, substitute $\eqref{eq:trigonometric_substitution_with_sine-first-radical-def}$ into it:

$$
\begin{equation}
\begin{split}
\int \frac{a \cos(\theta)}{\class{red}{\sqrt{a^2 - x^2}}}\dd{\theta} &= \int \frac{\cancel{a \cos(\theta)}}{\class{red}{\cancel{a \cos(\theta)}}}\dd{\theta} \\
&= \int \dd{\theta} = \theta + C
\end{split}
\end{equation}
$$

We can solve Equation $\eqref{eq:trigonometric_substitution_with_sine-first-x-def}$ for $\theta$ in terms of $\class{yellow}{x}$:

$$
\begin{equation}
\begin{split}
\sin(\theta) &= \frac{\class{yellow}{x}}{\class{green}{a}} \\
\theta &= \arcsin\qty(\frac{\class{yellow}{x}}{\class{green}{a}} )
\end{split}
\end{equation}
$$

Therefore:

$$
\begin{equation}
\int \frac{1}{\sqrt{a^2 - x^2}} \dd{x} = \arcsin\qty(\frac{x}{a}) + C
\end{equation}
$$

Another way to derive Equation $\eqref{eq:trigonometric_substitution_with_sine-first-radical-def}$ through the Pythagorean Identity:

$$
\begin{equation}
\begin{split}
\sqrt{\class{green}{a}^2 - \class{yellow}{x}^2} &= \sqrt{\class{green}{a}^2 - \class{yellow}{a^2 \sin^2(\theta)}} \\
&= \sqrt{\class{green}{a}^2(1 - \sin^2(\theta))} \\
&= \sqrt{\class{green}{a}^2\cos^2(\theta)} \\
&= \class{green}{a}\cos(\theta)
\end{split}
\end{equation}
$$

The advantage of this is that we do not have to construct a right triangle to derive it.

We can also make a general procedure for trigonometric substitution: For an integral that contains $a^2 - x^2$, make the substitution $x = a\sin(\theta)$.

### Trigonometric Substitution with Tangent

When we performed trigonometric substitution with $\sin$, we had the pattern of $a^2 - x^2$.
If we put this into a right triangle, then $a$ is the hypotenuse.

Now we look at an integral like this:

$$
\begin{equation}
\int \frac{1}{a^2 + x^2} \dd{x} \label{eq:trigonometric_substitution_with_tangent-first}
\end{equation}
$$

In an integral in this form, $a$ and $x$ are the sides of the right triangle.
As such, we can once again construct a triangle and use $\theta$ as our substitutent variable:

{(() => {
    const p1 = [-2, -2], p2 = [3, -2], p3 = [3, 2];
    return (
        <Mafs>
            <Line.Segment
                point1={p1}
                point2={p2}
                color={color("red")}
            />
            <LaTeX
                tex={"a"}
                at={lineLabel(p1, p2, "right")}
                color={color("red")}
            />

            <Line.Segment
                point1={p2}
                point2={p3}
                color={color("yellow")}
            />
            <LaTeX
                tex={"x"}
                at={lineLabel(p2, p3, "right")}
                color={color("yellow")}
            />

            <Line.Segment
                point1={p3}
                point2={p1}
                color={color("green")}
            />

            <Angle
                at={p2}
                fromRad={Math.PI / 2}
                toRad={Math.PI}
            />
            <Angle
                at={p1}
                fromRad={0}
                toRad={Math.atan((p3[1] - p2[1]) / (p2[0] - p1[0]))}
                label="\theta"
            />
        </Mafs>
    );
})()}

Using this triangle:

$$
\begin{align}
\tan(\theta) &= \frac{\class{yellow}{x}}{\class{red}{a}} \\
\class{yellow}{x} &= \class{red}{a} \tan(\theta) \label{eq:trigonometric_substitution_with_tangent-first-x-def} \\
\theta &= \arctan\qty(\frac{\class{yellow}{x}}{\class{red}{a}}) \label{eq:trigonometric_substitution_with_tangent-first-theta-def} \\
\dd{\class{yellow}{x}} &= \class{red}{a} \sec^2(\theta) \dd{\theta} \label{eq:trigonometric_substitution_with_tangent-first-dx-def}
\end{align}
$$

Using the Pythagorean Theorem, the length of the green line/hypotenuse is $\sqrt{\class{red}{a}^2 + \class{yellow}{x}^2}$. Hence:

$$
\begin{equation}
\begin{split}
\sec(\theta) &= \frac{\text{hyp}}{\text{adj}} = \frac{\class{green}{\sqrt{a^2 + x^2}}}{\class{red}{a}} \\
\class{green}{\sqrt{a^2 + x^2}} &= \class{red}{a} \sec(\theta) \\
\class{red}{a}^2 + \class{yellow}{x}^2 &= \class{red}{a}^2 \sec^2(\theta)
\end{split}
\end{equation}
$$

We can substitute this back into $\eqref{eq:trigonometric_substitution_with_tangent-first}$:

$$
\begin{equation}
\int \frac{1}{\class{red}{a}^2 + \class{yellow}{x}^2} \dd{x} = \int \frac{1}{\class{red}{a}^2 \sec^2(\theta)} \dd{x}
\end{equation}
$$

Now substitute $\eqref{eq:trigonometric_substitution_with_tangent-first-dx-def}$ into it:

$$
\begin{equation}
\int \frac{1}{\class{red}{a}^2 \sec^2(\theta)} \class{blue}{\dd{x}} = \int \frac{\class{blue}{a \cancel{\sec^2(\theta)}}}{\class{red}{a}^2 \cancel{\sec^2(\theta)}} \class{blue}{\dd{\theta}} = \frac{1}{\class{red}{a}} \theta + C
\end{equation}
$$

Finally, substitute $\eqref{eq:trigonometric_substitution_with_tangent-first-theta-def}$:

$$
\begin{equation}
\int \frac{1}{\class{red}{a}^2 + \class{yellow}{x}^2} \dd{x} = \frac{1}{\class{red}{a}}\arctan\qty(\frac{\class{yellow}{x}}{\class{red}{a}}) + C
\end{equation}
$$

### Example Problem: Trigonometric Substitution - $1/\sqrt{3 - 2x^2}$

> Evaluate the following integral:
>
> $$
> \begin{equation}
> \int \frac{1}{\sqrt{3 - 2x^2}} \dd{x} \label{eq:example_problem_trigonometric_substitution_1/sqrt(3-2x2)}
> \end{equation}
> $$

To solve this, we first need to get rid of the coefficient of $x$;

$$
\begin{equation}
\int \frac{1}{\sqrt{3 - 2x^2}} \dd{x} = \int \frac{1}{\sqrt{2(3/2 - x^2)}} \dd{x} = \int \frac{1}{\sqrt{2(\sqrt{3/2}^2 - x^2)}} \dd{x}
\end{equation}
$$

This becomes an integral of the form $1/\sqrt{a^2 - x^2}$ where $a = \sqrt{3/2}$. As such we can make the substitution $x = \sqrt{3/2}\sin(\theta)$.
Differentiating both sides w.r.t $\theta$, and solving for $\theta$ in terms of $x$:

$$
\begin{align}
x &= \sqrt{\frac{3}{2}}\sin(\theta) \\
\dd{x} &= \sqrt{\frac{3}{2}}\cos(\theta) \dd{\theta} \label{eq:example_problem_trigonometric_substitution_1/sqrt(3-2x2)-dx-def} \\
\theta &= \arcsin\qty(\sqrt{\frac{2}{3}}x) \label{eq:example_problem_trigonometric_substitution_1/sqrt(3-2x2)-theta-def}
\end{align}
$$

Calculate the denominator:

$$
\begin{equation}
\begin{split}
2\qty(\sqrt{\frac{3}{2}}^2 - x^2) &= 2\qty(\frac{3}{2} - \frac{3}{2}\sin^2(\theta)) \\
&= 3(1 - \sin^2(\theta))
\end{split}
\end{equation}
$$

Recall the Pythagorean identity $\sin^2(\theta) + \cos^2(\theta) = 1$ (which can be derived using the unit circle). Therefore:

$$
\begin{equation}
3 - 2x^2 = \dots = 3(1 - \sin^2(\theta)) = 3\cos^2(\theta)
\end{equation}
$$

Substituting this, along with Equation $\eqref{eq:example_problem_trigonometric_substitution_1/sqrt(3-2x2)-dx-def}$ back into $\eqref{eq:example_problem_trigonometric_substitution_1/sqrt(3-2x2)}$:

$$
\begin{equation}
\begin{split}
\int \frac{1}{\sqrt{3 - 2x^2}} \dd{x} &= \int \frac{1}{\sqrt{3\cos^2(\theta)}} \class{yellow}{\dd{x}} \\
&= \int \frac{\class{yellow}{\sqrt{3}/\sqrt{2} \cos(\theta)}}{\sqrt{3} \cos(\theta)} \class{yellow}{\dd{\theta}} \\
&= \int \frac{1}{\sqrt{2}} \dd{\theta} = \frac{1}{\sqrt{2}} \theta + C
\end{split}
\end{equation}
$$

Substituting $\eqref{eq:example_problem_trigonometric_substitution_1/sqrt(3-2x2)-theta-def}$:

$$
\begin{equation}
\int \frac{1}{\sqrt{3 - 2x^2}} \dd{x} = \frac{1}{\sqrt{2}} \theta + C = \frac{1}{\sqrt{2}} \arcsin\qty(\sqrt{\frac{2}{3}}x) + C
\end{equation}
$$

## Integration by Partial Fractions

Partial fractions is a technique used to integrate rational functions.

Consider the following integral:

$$
\begin{equation}
\int \frac{x - 5}{2x^2 - 5x + 3} \dd{x} \label{eq:integration_by_partial_fractions-original}
\end{equation}
$$

Maybe the first thing you think of is to see if the nuemrator is the derivative of the denominator, and if it is, then you can use $u$-substitution.
However, this is not the case here. Instead, we can use partial fractions.

We can factor $2x^2 - 5x + 3$:

$$
\begin{equation}
\begin{split}
2x^2 - 5x + 3 &= 2x^2 - 3x - 2x + 3 \\
&= x(2x - 3) - 1(2x - 3) \\
&= (x - 1)(2x - 3)
\end{split}
\end{equation}
$$

The key is that the denominator is a product, which means we can split it into two fractions:

$$
\begin{equation}
\frac{x - 5}{(x - 1)(2x - 3)} = \frac{A}{x - 1} + \frac{B}{2x - 3} \label{eq:integration_by_partial_fractions-split}
\end{equation}
$$

This can be thought of as the reverse of what you would usually do when adding fractions.

Note the variables $A$ and $B$ - although we know that the fraction can be split into two, we don't know what the numerators are. We can solve for them by multiplying both sides by the denominator:

$$
\begin{equation}
\begin{split}
\frac{A}{x - 1} + \frac{B}{2x - 3} &= \frac{A(2x - 3)}{(x - 1)(2x - 3)} + \frac{B(x - 1)}{(x - 1)(2x - 3)} \\
&= \frac{A(2x - 3) + B(x - 1)}{(x - 1)(2x - 3)} \\
&= \frac{\class{red}{2Ax} + \class{blue}{(-3A)} + \class{red}{Bx} + \class{blue}{(-B)}}{(x - 1)(2x - 3)} \\
&= \frac{\class{red}{(2A + B)x} + \class{blue}{(-3A - B)}}{(x - 1)(2x - 3)}
\end{split} \label{eq:integration_by_partial_fractions-numerator}
\end{equation}
$$

We now have two terms in the numerator, one with $x$ and one without $x$. Since all we did is rewrite the original fraction, we can equate the fraction in $\eqref{eq:integration_by_partial_fractions-original}$ and $\eqref{eq:integration_by_partial_fractions-numerator}$:

$$
\begin{equation}
\begin{split}
x - 5 &= (2A + B)x + (-3A - B) \\
\class{red}{1}x + \class{blue}{(-5)} &= \class{red}{(2A + B)}x + \class{blue}{(-3A - B)}
\end{split}
\end{equation}
$$

We can equate the coefficients of $x$ and the constant terms, forming a system of equations:

$$
\begin{equation}
\begin{cases}
2A + B = 1 \\
-3A - B = -5
\end{cases}
\end{equation}
$$

Solving this system of equations, we get $A = 4$ and $B = -7$.

<details>
<summary>Solving the System of Equations</summary>

Since the first equation has $+B$ and the second has $-B$, we can add the two equations to eliminate $B$:

$$
\begin{equation}
\begin{split}
2A + B &= 1 \notag \\
-3A - B &= -5 \notag \\
\hline
-1A + 0 &= -4 \\
A &= 4
\end{split}
\end{equation}
$$

Then, we can simply substitute $A = 4$ back into the first equation to get $B$:

$$
\begin{equation}
\begin{split}
2(4) + B &= 1 \\
8 + B &= 1 \\
B &= -7
\end{split}
\end{equation}
$$

</details>

Substitute $A = 4$ and $B = -7$ back into $\eqref{eq:integration_by_partial_fractions-split}$:

$$
\begin{equation}
\begin{split}
\int \frac{x - 5}{2x^2 - 5x + 3} \dd{x} &= \int \frac{4}{x - 1} - \frac{7}{2x - 3} \dd{x} \\
&= 4 \int \frac{1}{x - 1} \dd{x} - \frac{7}{2} \int \frac{2}{2x - 3} \dd{x} \\
\end{split}
\end{equation}
$$

Now we can integrate the two terms by reversing the chain rule:

$$
\begin{equation}
\begin{split}
\int \overbrace{\boxed{\frac{1}{\class{red}{\underbrace{x - 1}_{g(x)}}}}}^{f'(g(x))} \class{blue}{\underbrace{\dd{x}}_{g'(x)}} &= f(g(x)) + C \\
&= \ln|x - 1| + C \\
\int \overbrace{\boxed{\frac{2}{\class{red}{\underbrace{2x - 3}_{g(x)}}}}}^{f'(g(x))} \class{blue}{\underbrace{\dd{x}}_{g'(x)}} &= f(g(x)) + C \\
&= \ln|2x - 3| + C
\end{split}
\end{equation}
$$

Therefore, the integral at $\eqref{eq:integration_by_partial_fractions-original}$ can be rewritten as:

$$
\begin{equation}
\int \frac{x - 5}{2x^2 - 5x + 3} \dd{x} = 4\ln|x - 1| - \frac{7}{2}\ln|2x - 3| + C
\end{equation}
$$

## Improper Integrals

Integrals can contain bounds that are infinity.
Alternatively, the integrand might have a vertical asymptote in its interval.
These violate the typical assumptions for integrals, and are hence called _improper_ integrals.
Some improper integrals can be calculated using limits.

### Convergent Improper Integrals

Consider the following improper integral:

$$
\begin{equation}
\int_1^{\infty} \frac{1}{x^2} \dd{x}
\end{equation}
$$

An integral from $1$ to $\infty$ means the area under the curve that begins at $x = 1$ and never ends:

<Mafs>
    <Coordinates.Cartesian />
    <Plot.OfX y={(x) => 1 / (x ** 2)} />

    <Plot.Inequality
        y={{
            "<=": (x) => x > 1 ? 1 / (x ** 2) : 0,
            ">=": (x) => 0
        }}
    />
</Mafs>

Since you can't add infinite things, you consider what the area approaches as the upper bound approaches infinity - a limit:

$$
\begin{equation}
\begin{split}
\int_1^{\infty} \frac{1}{x^2} \dd{x} = \lim_{n \to \infty} \int_1^n \frac{1}{x^2} \dd{x} &= \lim_{n \to \infty} \frac{x^{-1}}{-1} \dd{x} \\
&= \lim_{n \to \infty}\qty(-\frac{1}{n} - \qty(-\frac{1}{1})) \\
&= \lim_{n \to \infty}\qty(-\frac{1}{n} + 1) = 1
\end{split}
\end{equation}
$$

Having a finite area, this integral is **convergent**.

### Divergent Improper Integrals

Unlike a convergent integral, a divergent integral goes to infinity.

For instance:

$$
\begin{equation}
\begin{split}
\int_1^{\infty} \frac{1}{x} \dd{x} = \lim_{n \to \infty} \int_1^n \frac{1}{x} \dd{x} &= \lim_{n \to \infty} (\ln|n| - \ln|1|) \\
\end{split}
\end{equation}
$$

Since $n, 1 > 0$, we can drop the absolute values.

$$
\begin{equation}
\begin{split}
\lim_{n \to \infty} (\ln|n| - \ln|1|) &= \lim_{n \to \infty} \ln(n) \\
&= \infty
\end{split}
\end{equation}
$$

As such, this integral is **divergent**.

## Worked Examples

### Example Problem: Combining $u$ and Trigonometric Substitution

> Evaluate the following integral:
>
> $$
> \begin{equation}
> \int x^3 \sqrt{9 - x^2} \dd{x} \label{eq:example_problem_combining_u_and_trigonometric_substitution-main}
> \end{equation}
> $$

Since we have $\sqrt{3^2 - x^2}$, we can substitute $x = 3\sin(\theta)$. As always:

$$
\begin{align}
x &= 3\sin(\theta) \label{eq:example_problem_combining_u_and_trigonometric_substitution-main-x-def} \\
\dd{x} &= 3\cos(\theta) \dd{\theta} \\
\theta &= \arcsin\qty(\frac{x}{3}) \label{eq:example_problem_combining_u_and_trigonometric_substitution-main-theta-def} \\
\sqrt{9 - x^2} &= \sqrt{9 - 9\sin^2(\theta)} \\
&= \sqrt{9(1 - \sin^2(\theta))} = 3\cos(\theta)
\end{align}
$$

Therefore, the integral at $\eqref{eq:example_problem_combining_u_and_trigonometric_substitution-main}$ can be rewritten as:

$$
\begin{equation}
\begin{split}
\int \class{red}{x^3} \class{blue}{\sqrt{9 - x^2}} \class{green}{\dd{x}} &= \int \class{red}{27\sin^3(\theta)} \class{blue}{3\cos(\theta)} \class{green}{3\cos(\theta) \dd{\theta}} \\
&= \int 243 \sin^3(\theta) \cos^2(\theta) \dd{\theta}
\end{split}
\end{equation}
$$

With odd powers of trigonometric functions, it is often helpful to separate them.

$$
\begin{equation}
\int 243 \sin^3(\theta) \cos^2(\theta) \dd{\theta} = 243 \int \sin^2(\theta) \cos^2(\theta) \sin(\theta) \dd{\theta}
\end{equation}
$$

Here, if we let $-\sin(\theta) \dd{\theta}$ be $\dd{u}$, then we need to make $u = \cos(\theta)$. To do so, we can make use of the Pythagorean identity once again:

$$
\begin{equation}
243 \int \class{red}{\sin^2(\theta)} \cos^2(\theta) \sin(\theta) \dd{\theta} = 243 \int \class{red}{(1 - \cos^2(\theta))} \cos^2(\theta) \sin(\theta) \dd{\theta}
\end{equation}
$$

This should be relatively obvious - we have a function of something ($\cos(\theta)$), as well as the derivative of that thing ($\sin(\theta)$).
Therefore we can apply $u$-substitution:

$$
\begin{align}
u &= \cos(\theta) \label{eq:example_problem_combining_u_and_trigonometric_substitution-u-def} \\
\dd{u} &= -\sin(\theta) \dd{\theta}
\end{align}
$$

Hence:

$$
\begin{equation}
\begin{split}
243 \int (1 - \cos^2(\theta)) \cos^2(\theta) \sin(\theta) \dd{\theta} &= -243 \int \class{red}{(1 - \cos^2(\theta)) \cos^2(\theta)} \class{blue}{(-\sin(\theta)) \dd{\theta}} \\
&= -243 \int \class{red}{(1 - u^2)u^2} \class{blue}{\dd{u}} \\
&= -243 \int (u^2 - u^4) \dd{u} \\
&= -243 \qty(\frac{u^3}{3} - \frac{u^5}{5}) + C
\end{split} \label{eq:example_problem_combining_u_and_trigonometric_substitution-answer-u}
\end{equation}
$$

We can manipulate $\eqref{eq:example_problem_combining_u_and_trigonometric_substitution-main-x-def}$ to derive an expression for $u$:

$$
\begin{equation}
\begin{split}
x &= 3\sin(\theta) \\
\frac{x}{3} &= \sin(\theta) \\
u = \cos(\theta) &= \sqrt{1 - \sin^2(\theta)} = \sqrt{1 - \frac{x^2}{9}}
\end{split}
\end{equation}
$$

Finally, substituting this back into $\eqref{eq:example_problem_combining_u_and_trigonometric_substitution-answer-u}$, and performing some algebra, we get the result:

$$
\begin{equation}
\begin{split}
\int x^3 \sqrt{9 - x^2} \dd{x} = \dots &= -243 \qty(\frac{u^3}{3} - \frac{u^5}{5}) + C \\
&= -243 \qty(\frac{\qty(1 - \frac{x^2}{9})^\frac{3}{2}}{3} - \frac{\qty(1 - \frac{x^2}{9})^\frac{5}{2}}{5}) + C \\
&= -243 \qty(\frac{\frac{1}{9^{3/2}} \qty(9 - x^2)^\frac{3}{2}}{3} - \frac{\frac{1}{9^{5/2}} \qty(9 - x^2)^\frac{5}{2}}{5}) + C \\
&= -243 \qty(\frac{\qty(9 - x^2)^\frac{3}{2}}{3 \cdot 3^3} - \frac{\qty(9 - x^2)^\frac{5}{2}}{5 \cdot 3^5} ) + C \\
&= -3(9 - x^2)^\frac{3}{2} + \frac{1}{5} (9 - x^2)^\frac{5}{2} + C
\end{split}
\end{equation}
$$

(More examples to come.)

## Summary

Integration is the process of finding the antiderivative of a function.

Indefinite integrals are integrals without bounds, while definite integrals have bounds, and describe the area under the curve.

Accumulation functions are used to find the total accumulation of a quantity over a given interval, and are defined via definite integrals.

The integral is formally defined as the limit of Riemann sums:

$$
\int_a^b f(x) \dd{x} = \lim_{n \to \infty} \sum_{i=1}^n f(x_i) \Delta x
$$

where $\Delta x = \frac{b - a}{n}$ and $x_i = a + i \Delta x$.

The fundamental theorem of calculus states that the integral of a function is the antiderivative of that function:

$$
\begin{equation}
\begin{split}
\dv{x} F(x) &= f(x) \\
\int_a^b f(x) \dd{x} &= F(b) - F(a)
\end{split}
\end{equation}
$$

There are several techniques to solve integrals:

- **$u$-substitution/reverse chain rule** is used to simplify the integrand by substituting a variable $u$:
    $$
    \begin{equation}
    \int f(g(x))g'(x) \dd{x} = \int f(u) \dd{u}
    \end{equation}
    $$
- **Algebraic manipulation**, such as long division, completing the square, or partial fractions, can simplify the integrand.
- **Integration by parts** is used to integrate the product of two functions:
    $$
    \begin{equation}
    \int f(x)g'(x) \dd{x} = f(x)g(x) - \int f'(x)g(x) \dd{x}
    \end{equation}
    $$
- **Trigonometric substitution** is used to substitute trigonometric functions to simplify the integrand:
    $$
    \begin{equation}
    \begin{split}
    \int \frac{1}{\sqrt{a^2 - x^2}} \dd{x} &= \arcsin\qty(\frac{x}{a}) + C \\
    \int \frac{1}{a^2 + x^2} \dd{x} &= \frac{1}{a}\arctan\qty(\frac{x}{a}) + C
    \end{split}
    \end{equation}
    $$

    Generally, for $\sqrt{a^2 - x^2}$, substitute $x = a\sin(\theta)$, and for $a^2 + x^2$, substitute $x = a\tan(\theta)$.

Improper integrals are integrals with infinite bounds or vertical asymptotes. They can be convergent or divergent.
