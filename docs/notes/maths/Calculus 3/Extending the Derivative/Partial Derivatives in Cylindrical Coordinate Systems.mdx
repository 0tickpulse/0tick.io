---
sidebar_position: 3
---

import { useMovablePoint, useStopwatch, vec } from "mafs";
import { useState, useRef, useCallback, useMemo, memo, Fragment } from "react";
import { lineLabel } from "@site/src/utilities/lines";
import { color, getColorFromMagnitude, gradient } from "@site/src/utilities/colors"
import TOCInline from '@theme/TOCInline';
import * as MB from "mathbox-react"
import * as THREE from "three"
import range from "lodash/range"
import { OrbitControls } from "three/examples/jsm/controls/OrbitControls"
import { easeInOutCubic } from "js-easing-functions";

# Partial Derivatives in Cylindrical Coordinate Systems

Previously, we discussed the gradient of a function in the context of Cartesian coordinates.
The gradient is actually quite different in other coordinate systems, so we will explore how the gradient changes in them.

## Table of Contents

<TOCInline toc={toc} />

## Polar/Cylindrical Coordinate Review

Before we delve into the gradient in polar/cylindrical coordinates, let's review what polar/cylindrical coordinates are.

Cylindrical coordinates are a coordinate system that uses a distance from the origin, an angle from the $x$-axis, and a height from the $xy$-plane to describe a point in space.
Those three values are denoted as $(r, \theta, z)$, respectively.

On the $xy$-plane, the cylindrical coordinates $(r, \theta)$ are equivalent to polar coordinates (which only use $(r, \theta)$).
We will use 2D diagrams to illustrate the concepts, but remember that cylindrical coordinates are 3D.

For this text, we will use the following colors and notation to represent the different coordinates:

- $\posX$, $\ihatc$: The $x$-coordinate and unit vector
- $\posY$, $\jhatc$: The $y$-coordinate and unit vector
- $\posR$, $\rhatc$: The distance from the origin
- $\posT$, $\thhatc$: The angle from the $x$-axis, and the tangent unit vector
- $\posZ$, $\khatc$: The height from the $xy$-plane, and the unit vector

Consider one point in the $xy$-plane with Cartesian coordinates $(\posX, \posY)$:

<PolarCoordinateVisualizer />


Using some trigonometry, we can convert the Cartesian coordinates $(\posX, \posY)$ to cylindrical coordinates $(\posR, \posT)$:

$$
\begin{align}
\posR &= \sqrt{\posX^2 + \posY^2} \\
\posT &= \arctan(\frac{\posY}{\posX}) \\
\posZ &= \posZ
\end{align}
$$

And to convert back to Cartesian coordinates:

$$
\begin{align}
\posX &= \posR \cos(\posT) \\
\posY &= \posR \sin(\posT) \\
\posZ &= \posZ
\end{align}
$$

We can compute the basis vectors for cylindrical coordinates in a similar way:

$$
\begin{align}
\rhatc &= \cos(\theta) \ihatc + \sin(\theta) \jhatc \\
\thhatc &= -\sin(\theta) \ihatc + \cos(\theta) \jhatc \\
\khatc &= \khatc
\end{align}
$$

Likewise, the unit vectors in Cartesian coordinates can be expressed in terms of cylindrical coordinates:

$$
\begin{align}
\ihatc &= \cos(\theta) \rhatc - \sin(\theta) \thhatc \label{eq:ihat-in-cylindrical} \\
\jhatc &= \sin(\theta) \rhatc + \cos(\theta) \thhatc \label{eq:jhat-in-cylindrical} \\
\khatc &= \khatc
\end{align}
$$

With this in mind, let's explore the gradient in polar/cylindrical coordinates.

## Partial Derivatives in Cylindrical Coordinates

### Partial Derivatives of r, Î¸, and z

Consider the partial derivative of $\posR$ with respect to $\class{yellow}{x}$:

$$
\begin{equation}
\pdv{\posR}{\posX} = \pdv{\sqrt{\posX^2 + \posY^2}}{\posX} = \frac{\posX}{\sqrt{\posX^2 + \posY^2}}
\end{equation}
$$

Next, consider taking the cosine of $\posT$:

$$
\begin{equation}
\cos(\posT) = \frac{\text{adjacent}}{\text{hypotenuse}} = \frac{\posX}{\sqrt{\posX^2 + \posY^2}}
\end{equation}
$$

Therefore:

$$
\begin{equation}
\pdv{\posR}{\posX} = \cos(\posT)
\end{equation}
$$

We can do the same for the partial derivative of $\posR$ with respect to $\posY$:

$$
\begin{equation}
\pdv{\posR}{\posY} = \pdv{\sqrt{\posX^2 + \posY^2}}{\posY} = \frac{\posY}{\sqrt{\posX^2 + \posY^2}} = \sin(\posT)
\end{equation}
$$

For the partial derivative of $\posR$ with respect to $\posZ$, consider that the radius does not change no matter how high or low the point is.
Therefore:

$$
\begin{equation}
\pdv{\posR}{\posZ} = 0
\end{equation}
$$

We can also compute the partial derivatives of $\posT$ and $\posZ$ with respect to $\posX$, $\posY$, and $\posZ$.
The results are:

$$
\begin{align}
\pdv{\posT}{\posX} &= -\frac{\posY}{\posX^2 + \posY^2} = -\frac{\sin(\posT)}{\posR} \\
\pdv{\posT}{\posY} &= \frac{\posX}{\posX^2 + \posY^2} = \frac{\cos(\posT)}{\posR} \\
\pdv{\posT}{\posZ} &= 0 \\
\pdv{\posZ}{\posX} &= 0 \\
\pdv{\posZ}{\posY} &= 0 \\
\pdv{\posZ}{\posZ} &= 1
\end{align}
$$

### Partial Derivatives of f

With that in mind, consider the partial derivative of a function $f$.
First, consider the partial derivative of $f$ with respect to the Cartesian coordinates.
By using the chain rule, we can express these as:

$$
\begin{align}
\pdv{f}{\posX} &= \pdv{f}{\posR} \pdv{\posR}{\posX} + \pdv{f}{\posT} \pdv{\posT}{\posX} + \pdv{f}{\posZ} \pdv{\posZ}{\posX} \\
\pdv{f}{\posY} &= \pdv{f}{\posR} \pdv{\posR}{\posY} + \pdv{f}{\posT} \pdv{\posT}{\posY} + \pdv{f}{\posZ} \pdv{\posZ}{\posY} \\
\pdv{f}{\posZ} &= \pdv{f}{\posR} \pdv{\posR}{\posZ} + \pdv{f}{\posT} \pdv{\posT}{\posZ} + \pdv{f}{\posZ} \pdv{\posZ}{\posZ}
\end{align}
$$

Since we have already computed the partial derivatives of $\posR$, $\posT$, and $\posZ$ with respect to the Cartesian coordinates, we can substitute them in:

$$
\begin{align}
\pdv{f}{\posX} &= \pdv{f}{\posR} \cos(\posT) - \pdv{f}{\posT} \frac{\sin(\posT)}{\posR} \label{eq:partial-x-in-cylindrical} \\
\pdv{f}{\posY} &= \pdv{f}{\posR} \sin(\posT) + \pdv{f}{\posT} \frac{\cos(\posT)}{\posR} \label{eq:partial-y-in-cylindrical} \\
\pdv{f}{\posZ} &= \pdv{f}{\posZ}
\end{align}
$$
